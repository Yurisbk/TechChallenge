/*! For license information please see module.js.LICENSE.txt */
define(["@emotion/css","@grafana/data","@grafana/runtime","@grafana/ui","app/core/core","lodash","moment","react","react-dom"],((e,t,n,r,o,a,s,i,l)=>(()=>{var c={42:(e,t)=>{var n;!function(){"use strict";var r={}.hasOwnProperty;function o(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var a=typeof n;if("string"===a||"number"===a)e.push(n);else if(Array.isArray(n)){if(n.length){var s=o.apply(null,n);s&&e.push(s)}}else if("object"===a){if(n.toString!==Object.prototype.toString&&!n.toString.toString().includes("[native code]")){e.push(n.toString());continue}for(var i in n)r.call(n,i)&&n[i]&&e.push(i)}}}return e.join(" ")}e.exports?(o.default=o,e.exports=o):void 0===(n=function(){return o}.apply(t,[]))||(e.exports=n)}()},8772:(e,t,n)=>{"use strict";var r=n(331);function o(){}function a(){}a.resetWarningCache=o,e.exports=function(){function e(e,t,n,o,a,s){if(s!==r){var i=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw i.name="Invariant Violation",i}}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:a,resetWarningCache:o};return n.PropTypes=n,n}},3615:(e,t,n)=>{e.exports=n(8772)()},331:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},7644:t=>{"use strict";t.exports=e},3305:e=>{"use strict";e.exports=t},3545:e=>{"use strict";e.exports=n},7388:e=>{"use strict";e.exports=r},7294:e=>{"use strict";e.exports=o},5980:e=>{"use strict";e.exports=a},8283:e=>{"use strict";e.exports=s},2650:e=>{"use strict";e.exports=i},2729:e=>{"use strict";e.exports=l}},u={};function p(e){var t=u[e];if(void 0!==t)return t.exports;var n=u[e]={exports:{}};return c[e](n,n.exports,p),n.exports}p.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return p.d(t,{a:t}),t},p.d=(e,t)=>{for(var n in t)p.o(t,n)&&!p.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},p.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),p.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var d={};return(()=>{"use strict";p.r(d),p.d(d,{plugin:()=>Xt});var e,t,n,r,o,a,s,i,l=p(3305),c=p(5980),u=p.n(c),m=p(8283),h=p.n(m);(o=e||(e={})).Group="group",o.Host="host",o.Application="application",o.Macro="macro",o.ItemTag="itemTag",o.Item="item",o.ItemValues="itemValues";class g extends l.BusEventWithPayload{}function f(e,t){const n=function(e){const t=[];let n=!1,r=!1;let o="";return u().forEach(e,(e=>{'"'===e&&r?o+=e:'"'===e&&n?n=!1:'"'!==e||n?"["!==e||n?"]"!==e||n?","!==e||n||r?o+=e:(t.push(o),o=""):r=!1:r=!0:n=!0})),t.push(o),t}(t.substring(t.indexOf("[")+1,t.lastIndexOf("]")));for(let t=n.length;t>=1;t--)e=e.replace("$"+t,n[t-1]);return e}function v(e,t){try{const n=function(e){const t=/(^[\d]+)(y|M|w|d|h|m|s)/g.exec(e);return h().duration(Number(t[1]),t[2]).valueOf()}(t);return Date.now()-1e3*e.timestamp<n}catch(e){return!1}}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}r="zbx-query-updated",(n="type")in(t=g)?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,(()=>{const e={},t=(0,l.getValueFormats)();for(const n of t)for(const t of n.submenu){const n=t.value;e[n]=n}})(),(i=a||(a={})).Problems="problems",i.Recent="recent",i.History="history",function(e){e.AndOr="0",e.Or="2"}(s||(s={}));var y=p(2650),E=p.n(y),w=p(3545),P=p(7294),C=p(7644),x=p(42),S=p.n(x),k=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function N(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}const T={get:function(e,t,n){if(!t)return e;var r=z(t),o=void 0;try{o=r.reduce((function(e,t){return e[t]}),e)}catch(e){}return void 0!==o?o:n},set:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[2],n=z(arguments[1]),r=void 0,o=e;(r=n.shift())&&n.length;)o[r]||(o[r]={}),o=o[r];return o[r]=t,e},takeRight:function(e,t){var n=t>e.length?0:e.length-t;return e.slice(n)},last:function(e){return e[e.length-1]},orderBy:function(e,t,n,r){return e.sort((function(e,o){for(var a=0;a<t.length;a+=1){var s=t[a],i=!1===n[a]||"desc"===n[a],l=s(e,o);if(l)return i?-l:l}return n[0]?e[r]-o[r]:o[r]-e[r]}))},range:function(e){for(var t=[],n=0;n<e;n+=1)t.push(e);return t},remove:function(e,t){return e.filter((function(n,r){return!!t(n)&&(e.splice(r,1),!0)}))},clone:function(e){try{return JSON.parse(JSON.stringify(e,(function(e,t){return"function"==typeof t?t.toString():t})))}catch(t){return e}},getFirstDefined:function(){for(var e=0;e<arguments.length;e+=1)if(void 0!==(arguments.length<=e?void 0:arguments[e]))return arguments.length<=e?void 0:arguments[e]},sum:function(e){return e.reduce((function(e,t){return e+t}),0)},makeTemplateComponent:function(e,t){if(!t)throw new Error("No displayName found for template component:",e);var n=function(t){var n=t.children,r=t.className,o=N(t,["children","className"]);return E().createElement("div",k({className:S()(e,r)},o),n)};return n.displayName=t,n},groupBy:function(e,t){return e.reduce((function(e,n,r){var o="function"==typeof t?t(n,r):n[t];return e[o]=O(e[o])?e[o]:[],e[o].push(n),e}),{})},isArray:O,splitProps:function(e){return{className:e.className,style:e.style,rest:N(e,["className","style"])||{}}},compactObject:function(e){var t={};return e&&Object.keys(e).map((function(n){return Object.prototype.hasOwnProperty.call(e,n)&&void 0!==e[n]&&void 0!==e[n]&&(t[n]=e[n]),!0})),t},isSortingDesc:function(e){return!("desc"!==e.sort&&!0!==e.desc&&!1!==e.asc)},normalizeComponent:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;return function(e){return"function"==typeof e&&!!Object.getPrototypeOf(e).isReactComponent}(n=e)||function(e){return"function"==typeof e&&String(e).includes(".createElement")}(n)?E().createElement(e,t):"function"==typeof e?e(t):r},asPx:function(e){return e=Number(e),Number.isNaN(e)?null:e+"px"}};function O(e){return Array.isArray(e)}function z(e){return F(e).join(".").replace(/\[/g,".").replace(/\]/g,"").split(".")}function F(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(O(e))for(var n=0;n<e.length;n+=1)F(e[n],t);else t.push(e);return t}var D=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),R=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},M=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function j(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function H(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var A=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),$=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},B=function(e){return E().createElement("button",$({type:"button"},e,{className:"-btn"}),e.children)},_=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getSafePage=n.getSafePage.bind(n),n.changePage=n.changePage.bind(n),n.applyPage=n.applyPage.bind(n),n.state={page:e.page},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),A(t,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.props.page!==e.page&&this.setState({page:e.page})}},{key:"getSafePage",value:function(e){return Number.isNaN(e)&&(e=this.props.page),Math.min(Math.max(e,0),this.props.pages-1)}},{key:"changePage",value:function(e){e=this.getSafePage(e),this.setState({page:e}),this.props.page!==e&&this.props.onPageChange(e)}},{key:"applyPage",value:function(e){e&&e.preventDefault();var t=this.state.page;this.changePage(""===t?this.props.page:t)}},{key:"getPageJumpProperties",value:function(){var e=this;return{onKeyPress:function(t){13!==t.which&&13!==t.keyCode||e.applyPage()},onBlur:this.applyPage,value:""===this.state.page?"":this.state.page+1,onChange:function(t){var n=t.target.value,r=n-1;if(""===n)return e.setState({page:n});e.setState({page:e.getSafePage(r)})},inputType:""===this.state.page?"text":"number",pageJumpText:this.props.pageJumpText}}},{key:"render",value:function(){var e=this,t=this.props,n=t.pages,r=t.page,o=t.showPageSizeOptions,a=t.pageSizeOptions,s=t.pageSize,i=t.showPageJump,l=t.canPrevious,c=t.canNext,u=t.onPageSizeChange,p=t.className,d=t.PreviousComponent,m=t.NextComponent,h=t.renderPageJump,g=t.renderCurrentPage,f=t.renderTotalPagesCount,v=t.renderPageSizeOptions;return E().createElement("div",{className:S()(p,"-pagination"),style:this.props.style},E().createElement("div",{className:"-previous"},E().createElement(d,{onClick:function(){l&&e.changePage(r-1)},disabled:!l},this.props.previousText)),E().createElement("div",{className:"-center"},E().createElement("span",{className:"-pageInfo"},this.props.pageText," ",i?h(this.getPageJumpProperties()):g(r)," ",this.props.ofText," ",f(n)),o&&v({pageSize:s,rowsSelectorText:this.props.rowsSelectorText,pageSizeOptions:a,onPageSizeChange:u,rowsText:this.props.rowsText})),E().createElement("div",{className:"-next"},E().createElement(m,{onClick:function(){c&&e.changePage(r+1)},disabled:!c},this.props.nextText)))}}]),t}(y.Component);_.defaultProps={PreviousComponent:B,NextComponent:B,renderPageJump:function(e){var t=e.onChange,n=e.value,r=e.onBlur,o=e.onKeyPress,a=e.inputType,s=e.pageJumpText;return E().createElement("div",{className:"-pageJump"},E().createElement("input",{"aria-label":s,type:a,onChange:t,value:n,onBlur:r,onKeyPress:o}))},renderCurrentPage:function(e){return E().createElement("span",{className:"-currentPage"},e+1)},renderTotalPagesCount:function(e){return E().createElement("span",{className:"-totalPages"},e||1)},renderPageSizeOptions:function(e){var t=e.pageSize,n=e.pageSizeOptions,r=e.rowsSelectorText,o=e.onPageSizeChange,a=e.rowsText;return E().createElement("span",{className:"select-wrap -pageSizeOptions"},E().createElement("select",{"aria-label":r,onChange:function(e){return o(Number(e.target.value))},value:t},n.map((function(e,t){return E().createElement("option",{key:t,value:e},e+" "+a)}))))}};const I=_;var W=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function L(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}var G=function(){return{}};const K={data:[],resolveData:function(e){return e},loading:!1,showPagination:!0,showPaginationTop:!1,showPaginationBottom:!0,showPageSizeOptions:!0,pageSizeOptions:[5,10,20,25,50,100],defaultPage:0,defaultPageSize:20,showPageJump:!0,collapseOnSortingChange:!0,collapseOnPageChange:!0,collapseOnDataChange:!0,freezeWhenExpanded:!1,sortable:!0,multiSort:!0,resizable:!0,filterable:!1,defaultSortDesc:!1,defaultSorted:[],defaultFiltered:[],defaultResized:[],defaultExpanded:{},defaultFilterMethod:function(e,t,n){var r=e.pivotId||e.id;return void 0===t[r]||String(t[r]).startsWith(e.value)},defaultSortMethod:function(e,t,n){return t=null==t?"":t,(e="string"==typeof(e=null==e?"":e)?e.toLowerCase():e)>(t="string"==typeof t?t.toLowerCase():t)?1:e<t?-1:0},onPageChange:void 0,onPageSizeChange:void 0,onSortedChange:void 0,onFilteredChange:void 0,onResizedChange:void 0,onExpandedChange:void 0,pivotBy:void 0,pivotValKey:"_pivotVal",pivotIDKey:"_pivotID",subRowsKey:"_subRows",aggregatedKey:"_aggregated",nestingLevelKey:"_nestingLevel",originalKey:"_original",indexKey:"_index",groupedByPivotKey:"_groupedByPivot",onFetchData:function(){return null},className:"",style:{},getProps:G,getTableProps:G,getTheadGroupProps:G,getTheadGroupTrProps:G,getTheadGroupThProps:G,getTheadProps:G,getTheadTrProps:G,getTheadThProps:G,getTheadFilterProps:G,getTheadFilterTrProps:G,getTheadFilterThProps:G,getTbodyProps:G,getTrGroupProps:G,getTrProps:G,getTdProps:G,getTfootProps:G,getTfootTrProps:G,getTfootTdProps:G,getPaginationProps:G,getLoadingProps:G,getNoDataProps:G,getResizerProps:G,column:{Cell:void 0,Header:void 0,Footer:void 0,Aggregated:void 0,Pivot:void 0,PivotValue:void 0,Expander:void 0,Filter:void 0,Placeholder:void 0,sortable:void 0,resizable:void 0,filterable:void 0,show:!0,minWidth:100,minResizeWidth:11,className:"",style:{},getProps:G,aggregate:void 0,headerClassName:"",headerStyle:{},getHeaderProps:G,footerClassName:"",footerStyle:{},getFooterProps:G,filterMethod:void 0,filterAll:!1,sortMethod:void 0},expanderDefaults:{sortable:!1,resizable:!1,filterable:!1,width:35},pivotDefaults:{},previousText:"Previous",nextText:"Next",loadingText:"Loading...",noDataText:"No rows found",pageText:"Page",ofText:"of",rowsText:"rows",pageJumpText:"jump to page",rowsSelectorText:"rows per page",TableComponent:function(e){var t=e.children,n=e.className,r=L(e,["children","className"]);return E().createElement("div",W({className:S()("rt-table",n),role:"grid"},r),t)},TheadComponent:T.makeTemplateComponent("rt-thead","Thead"),TbodyComponent:T.makeTemplateComponent("rt-tbody","Tbody"),TrGroupComponent:function(e){var t=e.children,n=e.className,r=L(e,["children","className"]);return E().createElement("div",W({className:S()("rt-tr-group",n),role:"rowgroup"},r),t)},TrComponent:function(e){var t=e.children,n=e.className,r=L(e,["children","className"]);return E().createElement("div",W({className:S()("rt-tr",n),role:"row"},r),t)},ThComponent:function(e){var t=e.toggleSort,n=e.className,r=e.children,o=L(e,["toggleSort","className","children"]);return E().createElement("div",W({className:S()("rt-th",n),onClick:function(e){return t&&t(e)},role:"columnheader",tabIndex:"-1"},o),r)},TdComponent:function(e){e.toggleSort;var t=e.className,n=e.children,r=L(e,["toggleSort","className","children"]);return E().createElement("div",W({className:S()("rt-td",t),role:"gridcell"},r),n)},TfootComponent:T.makeTemplateComponent("rt-tfoot","Tfoot"),FilterComponent:function(e){var t=e.filter,n=e.onChange,r=e.column;return E().createElement("input",{type:"text",style:{width:"100%"},placeholder:r.Placeholder,value:t?t.value:"",onChange:function(e){return n(e.target.value)}})},ExpanderComponent:function(e){var t=e.isExpanded;return E().createElement("div",{className:S()("rt-expander",t&&"-open")},"•")},PivotValueComponent:function(e){var t=e.subRows,n=e.value;return E().createElement("span",null,n," ",t&&"("+t.length+")")},AggregatedComponent:function(e){var t=e.subRows,n=e.column,r=t.filter((function(e){return void 0!==e[n.id]})).map((function(e,r){return E().createElement("span",{key:r},e[n.id],r<t.length-1?", ":"")}));return E().createElement("span",null,r)},PivotComponent:void 0,PaginationComponent:I,PreviousComponent:void 0,NextComponent:void 0,LoadingComponent:function(e){var t=e.className,n=e.loading,r=e.loadingText,o=L(e,["className","loading","loadingText"]);return E().createElement("div",W({className:S()("-loading",{"-active":n},t)},o),E().createElement("div",{className:"-loading-inner"},r))},NoDataComponent:T.makeTemplateComponent("rt-noData","NoData"),ResizerComponent:T.makeTemplateComponent("rt-resizer","Resizer"),PadRowComponent:function(){return E().createElement("span",null," ")}};var V=p(3615),U=p.n(V);const J={data:U().any,loading:U().bool,showPagination:U().bool,showPaginationTop:U().bool,showPaginationBottom:U().bool,showPageSizeOptions:U().bool,pageSizeOptions:U().array,defaultPageSize:U().number,showPageJump:U().bool,collapseOnSortingChange:U().bool,collapseOnPageChange:U().bool,collapseOnDataChange:U().bool,freezeWhenExpanded:U().bool,sortable:U().bool,resizable:U().bool,filterable:U().bool,defaultSortDesc:U().bool,defaultSorted:U().array,defaultFiltered:U().array,defaultResized:U().array,defaultExpanded:U().object,defaultFilterMethod:U().func,defaultSortMethod:U().func,onPageChange:U().func,onPageSizeChange:U().func,onSortedChange:U().func,onFilteredChange:U().func,onResizedChange:U().func,onExpandedChange:U().func,pivotBy:U().array,pivotValKey:U().string,pivotIDKey:U().string,subRowsKey:U().string,aggregatedKey:U().string,nestingLevelKey:U().string,originalKey:U().string,indexKey:U().string,groupedByPivotKey:U().string,onFetchData:U().func,className:U().string,style:U().object,getProps:U().func,getTableProps:U().func,getTheadGroupProps:U().func,getTheadGroupTrProps:U().func,getTheadGroupThProps:U().func,getTheadProps:U().func,getTheadTrProps:U().func,getTheadThProps:U().func,getTheadFilterProps:U().func,getTheadFilterTrProps:U().func,getTheadFilterThProps:U().func,getTbodyProps:U().func,getTrGroupProps:U().func,getTrProps:U().func,getTdProps:U().func,getTfootProps:U().func,getTfootTrProps:U().func,getTfootTdProps:U().func,getPaginationProps:U().func,getLoadingProps:U().func,getNoDataProps:U().func,getResizerProps:U().func,columns:U().arrayOf(U().shape({Cell:U().oneOfType([U().element,U().string,U().func]),Header:U().oneOfType([U().element,U().string,U().func]),Footer:U().oneOfType([U().element,U().string,U().func]),Aggregated:U().oneOfType([U().element,U().string,U().func]),Pivot:U().oneOfType([U().element,U().string,U().func]),PivotValue:U().oneOfType([U().element,U().string,U().func]),Expander:U().oneOfType([U().element,U().string,U().func]),Filter:U().oneOfType([U().element,U().func]),sortable:U().bool,resizable:U().bool,filterable:U().bool,show:U().bool,minWidth:U().number,minResizeWidth:U().number,className:U().string,style:U().object,getProps:U().func,aggregate:U().func,headerClassName:U().string,headerStyle:U().object,getHeaderProps:U().func,footerClassName:U().string,footerStyle:U().object,getFooterProps:U().func,filterMethod:U().func,filterAll:U().bool,sortMethod:U().func})),expanderDefaults:U().shape({sortable:U().bool,resizable:U().bool,filterable:U().bool,width:U().number}),pivotDefaults:U().object,previousText:U().node,nextText:U().node,loadingText:U().node,noDataText:U().node,pageText:U().node,ofText:U().node,rowsText:U().node,pageJumpText:U().node,rowsSelectorText:U().node,TableComponent:U().elementType,TheadComponent:U().elementType,TbodyComponent:U().elementType,TrGroupComponent:U().elementType,TrComponent:U().elementType,ThComponent:U().elementType,TdComponent:U().elementType,TfootComponent:U().elementType,FilterComponent:U().elementType,ExpanderComponent:U().elementType,PivotValueComponent:U().elementType,AggregatedComponent:U().elementType,PivotComponent:U().elementType,PaginationComponent:U().elementType,PreviousComponent:U().elementType,NextComponent:U().elementType,LoadingComponent:U().elementType,NoDataComponent:U().elementType,ResizerComponent:U().elementType,PadRowComponent:U().elementType};var q=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,a=void 0;try{for(var s,i=e[Symbol.iterator]();!(r=(s=i.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{!r&&i.return&&i.return()}finally{if(o)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},Y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},X=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Q=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.getResolvedState=n.getResolvedState.bind(n),n.getDataModel=n.getDataModel.bind(n),n.getSortedData=n.getSortedData.bind(n),n.fireFetchData=n.fireFetchData.bind(n),n.getPropOrState=n.getPropOrState.bind(n),n.getStateOrProp=n.getStateOrProp.bind(n),n.filterData=n.filterData.bind(n),n.sortData=n.sortData.bind(n),n.getMinRows=n.getMinRows.bind(n),n.onPageChange=n.onPageChange.bind(n),n.onPageSizeChange=n.onPageSizeChange.bind(n),n.sortColumn=n.sortColumn.bind(n),n.filterColumn=n.filterColumn.bind(n),n.resizeColumnStart=n.resizeColumnStart.bind(n),n.resizeColumnEnd=n.resizeColumnEnd.bind(n),n.resizeColumnMoving=n.resizeColumnMoving.bind(n),n.state={page:e.defaultPage,pageSize:e.defaultPageSize,sorted:e.defaultSorted,expanded:e.defaultExpanded,filtered:e.defaultFiltered,resized:e.defaultResized,currentlyResizing:!1,skipNextSort:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),X(t,[{key:"render",value:function(){var e=this,t=this.getResolvedState(),n=t.children,r=t.className,o=t.style,a=t.getProps,s=t.getTableProps,i=t.getTheadGroupProps,l=t.getTheadGroupTrProps,c=t.getTheadGroupThProps,u=t.getTheadProps,p=t.getTheadTrProps,d=t.getTheadThProps,m=t.getTheadFilterProps,h=t.getTheadFilterTrProps,g=t.getTheadFilterThProps,f=t.getTbodyProps,v=t.getTrGroupProps,b=t.getTrProps,y=t.getTdProps,w=t.getTfootProps,P=t.getTfootTrProps,C=t.getTfootTdProps,x=t.getPaginationProps,k=t.getLoadingProps,N=t.getNoDataProps,O=t.getResizerProps,z=t.showPagination,F=t.showPaginationTop,D=t.showPaginationBottom,R=t.manual,M=t.loadingText,j=t.noDataText,H=t.sortable,A=t.multiSort,$=t.resizable,B=t.filterable,_=t.pivotIDKey,I=t.pivotValKey,W=t.pivotBy,L=t.subRowsKey,G=t.aggregatedKey,V=t.originalKey,U=t.indexKey,J=t.groupedByPivotKey,X=t.loading,Q=t.pageSize,Z=t.page,ee=t.sorted,te=t.filtered,ne=t.resized,re=t.expanded,oe=t.pages,ae=t.onExpandedChange,se=t.TableComponent,ie=t.TheadComponent,le=t.TbodyComponent,ce=t.TrGroupComponent,ue=t.TrComponent,pe=t.ThComponent,de=t.TdComponent,me=t.TfootComponent,he=t.PaginationComponent,ge=t.LoadingComponent,fe=t.SubComponent,ve=t.NoDataComponent,be=t.ResizerComponent,ye=t.ExpanderComponent,Ee=t.PivotValueComponent,we=t.PivotComponent,Pe=t.AggregatedComponent,Ce=t.FilterComponent,xe=t.PadRowComponent,Se=t.resolvedData,ke=t.allVisibleColumns,Ne=t.headerGroups,Te=t.hasHeaderGroups,Oe=t.sortedData,ze=t.currentlyResizing,Fe=Q*Z,De=Fe+Q,Re=R?Se:Oe.slice(Fe,De),Me=this.getMinRows(),je=T.range(Math.max(Me-Re.length,0)),He=ke.some((function(e){return e.Footer})),Ae=B||ke.some((function(e){return e.filterable})),$e=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;return[t.map((function(t,o){var a=Y({},t,{_viewIndex:r+=1}),s=n.concat([o]);if(a[L]&&T.get(re,s)){var i=e(a[L],s,r),l=q(i,2);a[L]=l[0],r=l[1]}return a})),r]}(Re),Be=q($e,1);Re=Be[0];var _e=Z>0,Ie=Z+1<oe,We=T.sum(ke.map((function(e){var t=ne.find((function(t){return t.id===e.id}))||{};return T.getFirstDefined(t.value,e.width,e.minWidth)}))),Le=-1,Ge=Y({},t,{startRow:Fe,endRow:De,pageRows:Re,minRows:Me,padRows:je,hasColumnFooter:He,canPrevious:_e,canNext:Ie,rowMinWidth:We}),Ke=T.splitProps(a(Ge,void 0,void 0,this)),Ve=T.splitProps(s(Ge,void 0,void 0,this)),Ue=T.splitProps(f(Ge,void 0,void 0,this)),Je=k(Ge,void 0,void 0,this),qe=N(Ge,void 0,void 0,this),Ye=function(t,n){var r=function(e){return(ne.find((function(t){return t.id===e.id}))||{}).value},o=T.sum(t.columns.map((function(e){return e.width||r(e)?0:e.minWidth}))),a=T.sum(t.columns.map((function(e){return T.getFirstDefined(r(e),e.width,e.minWidth)}))),s=T.sum(t.columns.map((function(e){return T.getFirstDefined(r(e),e.width,e.maxWidth)}))),i=T.splitProps(c(Ge,void 0,t,e)),l=T.splitProps(t.getHeaderProps(Ge,void 0,t,e)),u=[t.headerClassName,i.className,l.className],p=Y({},t.headerStyle,i.style,l.style),d=Y({},i.rest,l.rest),m={flex:o+" 0 auto",width:T.asPx(a),maxWidth:T.asPx(s)};return E().createElement(pe,Y({key:n+"-"+t.id,className:S()(u),style:Y({},p,m)},d),T.normalizeComponent(t.Header,{data:Oe,column:t}))},Xe=function(t,n){var r=ne.find((function(e){return e.id===t.id}))||{},o=ee.find((function(e){return e.id===t.id})),a="function"==typeof t.show?t.show():t.show,s=T.getFirstDefined(r.value,t.width,t.minWidth),i=T.getFirstDefined(r.value,t.width,t.maxWidth),l=T.splitProps(d(Ge,void 0,t,e)),c=T.splitProps(t.getHeaderProps(Ge,void 0,t,e)),u=[t.headerClassName,l.className,c.className],p=Y({},t.headerStyle,l.style,c.style),m=Y({},l.rest,c.rest),h=T.getFirstDefined(t.resizable,$,!1),g=h?E().createElement(be,Y({onMouseDown:function(n){return e.resizeColumnStart(n,t,!1)},onTouchStart:function(n){return e.resizeColumnStart(n,t,!0)}},O("finalState",void 0,t,e))):null,f=T.getFirstDefined(t.sortable,H,!1);return E().createElement(pe,Y({key:n+"-"+t.id,className:S()(u,h&&"rt-resizable-header",o?o.desc?"-sort-desc":"-sort-asc":"",f&&"-cursor-pointer",!a&&"-hidden",W&&W.slice(0,-1).includes(t.id)&&"rt-header-pivot"),style:Y({},p,{flex:s+" 0 auto",width:T.asPx(s),maxWidth:T.asPx(i)}),toggleSort:function(n){f&&e.sortColumn(t,!!A&&n.shiftKey)}},m),E().createElement("div",{className:S()(h&&"rt-resizable-header-content")},T.normalizeComponent(t.Header,{data:Oe,column:t})),g)},Qe=function(t,n){var r=ne.find((function(e){return e.id===t.id}))||{},o=T.getFirstDefined(r.value,t.width,t.minWidth),a=T.getFirstDefined(r.value,t.width,t.maxWidth),s=T.splitProps(g(Ge,void 0,t,e)),i=T.splitProps(t.getHeaderProps(Ge,void 0,t,e)),l=[t.headerClassName,s.className,i.className],c=Y({},t.headerStyle,s.style,i.style),u=Y({},s.rest,i.rest),p=te.find((function(e){return e.id===t.id})),d=t.Filter||Ce,m=T.getFirstDefined(t.filterable,B,!1);return E().createElement(pe,Y({key:n+"-"+t.id,className:S()(l),style:Y({},c,{flex:o+" 0 auto",width:T.asPx(o),maxWidth:T.asPx(a)})},u),m?T.normalizeComponent(d,{column:t,filter:p,onChange:function(n){return e.filterColumn(t,n)}},K.column.Filter):null)},Ze=function t(n,r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a={original:n[V],row:n,index:n[U],viewIndex:Le+=1,pageSize:Q,page:Z,level:o.length,nestingPath:o.concat([r]),aggregated:n[G],groupedByPivot:n[J],subRows:n[L]},s=T.get(re,a.nestingPath),i=v(Ge,a,void 0,e),l=T.splitProps(b(Ge,a,void 0,e));return E().createElement(ce,Y({key:a.nestingPath.join("_")},i),E().createElement(ue,Y({className:S()(l.className,n._viewIndex%2?"-even":"-odd"),style:l.style},l.rest),ke.map((function(t,r){var o=ne.find((function(e){return e.id===t.id}))||{},i="function"==typeof t.show?t.show():t.show,l=T.getFirstDefined(o.value,t.width,t.minWidth),c=T.getFirstDefined(o.value,t.width,t.maxWidth),u=T.splitProps(y(Ge,a,t,e)),p=T.splitProps(t.getProps(Ge,a,t,e)),d=[u.className,t.className,p.className],m=Y({},u.style,t.style,p.style),h=Y({},a,{isExpanded:s,column:Y({},t),value:a.row[t.id],pivoted:t.pivoted,expander:t.expander,resized:ne,show:i,width:l,maxWidth:c,tdProps:u,columnProps:p,classes:d,styles:m}),g=h.value,f=void 0,v=void 0,b=void 0,w=T.normalizeComponent(t.Cell,h,g),P=t.Aggregated||(t.aggregate?t.Cell:Pe),C=t.Expander||ye,x=t.PivotValue||Ee,k=we||function(e){return E().createElement("div",null,E().createElement(C,e),E().createElement(x,e))},N=t.Pivot||k;(h.pivoted||h.expander)&&(h.expandable=!0,f=!0,!h.pivoted||h.subRows||fe||(h.expandable=!1)),h.pivoted?(v=a.row[_]===t.id&&h.subRows,b=W.indexOf(t.id)>W.indexOf(a.row[_])&&h.subRows,w=v?T.normalizeComponent(N,Y({},h,{value:n[I]}),n[I]):b?T.normalizeComponent(P,h,g):null):h.aggregated&&(w=T.normalizeComponent(P,h,g)),h.expander&&(w=T.normalizeComponent(C,h,n[I]),W&&(h.groupedByPivot&&(w=null),h.subRows||fe||(w=null)));var O=f?function(t){var n=T.clone(re);return n=s?T.set(n,h.nestingPath,!1):T.set(n,h.nestingPath,{}),e.setStateWithData({expanded:n},(function(){return ae&&ae(n,h.nestingPath,t,h)}))}:function(){},z={onClick:O};return u.rest.onClick&&(z.onClick=function(e){u.rest.onClick(e,(function(){return O(e)}))}),p.rest.onClick&&(z.onClick=function(e){p.rest.onClick(e,(function(){return O(e)}))}),E().createElement(de,Y({key:r+"-"+t.id,className:S()(d,!h.expandable&&!i&&"hidden",h.expandable&&"rt-expandable",(v||b)&&"rt-pivot"),style:Y({},m,{flex:l+" 0 auto",width:T.asPx(l),maxWidth:T.asPx(c)})},u.rest,p.rest,z),w)}))),a.subRows&&s&&a.subRows.map((function(e,n){return t(e,n,a.nestingPath)})),fe&&!a.subRows&&s&&fe(a,(function(){var e=T.clone(re);T.set(e,a.nestingPath,!1)})))},et=function(t,n){var r=ne.find((function(e){return e.id===t.id}))||{},o="function"==typeof t.show?t.show():t.show,a=T.getFirstDefined(r.value,t.width,t.minWidth),s=a,i=T.getFirstDefined(r.value,t.width,t.maxWidth),l=T.splitProps(y(Ge,void 0,t,e)),c=T.splitProps(t.getProps(Ge,void 0,t,e)),u=[l.className,t.className,c.className],p=Y({},l.style,t.style,c.style);return E().createElement(de,Y({key:n+"-"+t.id,className:S()(u,!o&&"hidden"),style:Y({},p,{flex:s+" 0 auto",width:T.asPx(a),maxWidth:T.asPx(i)})},l.rest),T.normalizeComponent(xe))},tt=function(t,n){var r=v(Ge,void 0,void 0,e),o=T.splitProps(b(Ge,void 0,void 0,e));return E().createElement(ce,Y({key:"pad-"+n},r),E().createElement(ue,{className:S()("-padRow",(Re.length+n)%2?"-even":"-odd",o.className),style:o.style||{}},ke.map(et)))},nt=function(t,n){var r=ne.find((function(e){return e.id===t.id}))||{},o="function"==typeof t.show?t.show():t.show,a=T.getFirstDefined(r.value,t.width,t.minWidth),s=T.getFirstDefined(r.value,t.width,t.maxWidth),i=T.splitProps(C(Ge,void 0,t,e)),l=T.splitProps(t.getProps(Ge,void 0,t,e)),c=T.splitProps(t.getFooterProps(Ge,void 0,t,e)),u=[i.className,t.className,l.className,c.className],p=Y({},i.style,t.style,l.style,c.style);return E().createElement(de,Y({key:n+"-"+t.id,className:S()(u,!o&&"hidden"),style:Y({},p,{flex:a+" 0 auto",width:T.asPx(a),maxWidth:T.asPx(s)})},l.rest,i.rest,c.rest),T.normalizeComponent(t.Footer,{data:Oe,column:t}))},rt=function(n){var r=T.splitProps(x(Ge,void 0,void 0,e));return E().createElement(he,Y({},t,{pages:oe,canPrevious:_e,canNext:Ie,onPageChange:e.onPageChange,onPageSizeChange:e.onPageSizeChange,className:r.className,style:r.style,isTop:n},r.rest))},ot=function(){return E().createElement("div",Y({className:S()("ReactTable",r,Ke.className),style:Y({},o,Ke.style)},Ke.rest),z&&F?E().createElement("div",{className:"pagination-top"},rt(!0)):null,E().createElement(se,Y({className:S()(Ve.className,ze?"rt-resizing":""),style:Ve.style},Ve.rest),Te?(g=T.splitProps(i(Ge,void 0,void 0,e)),f=T.splitProps(l(Ge,void 0,void 0,e)),E().createElement(ie,Y({className:S()("-headerGroups",g.className),style:Y({},g.style,{minWidth:We+"px"})},g.rest),E().createElement(ue,Y({className:f.className,style:f.style},f.rest),Ne.map(Ye)))):null,(c=T.splitProps(u(Ge,void 0,void 0,e)),d=T.splitProps(p(Ge,void 0,void 0,e)),E().createElement(ie,Y({className:S()("-header",c.className),style:Y({},c.style,{minWidth:We+"px"})},c.rest),E().createElement(ue,Y({className:d.className,style:d.style},d.rest),ke.map(Xe)))),Ae?(a=T.splitProps(m(Ge,void 0,void 0,e)),s=T.splitProps(h(Ge,void 0,void 0,e)),E().createElement(ie,Y({className:S()("-filters",a.className),style:Y({},a.style,{minWidth:We+"px"})},a.rest),E().createElement(ue,Y({className:s.className,style:s.style},s.rest),ke.map(Qe)))):null,E().createElement(le,Y({className:S()(Ue.className),style:Y({},Ue.style,{minWidth:We+"px"})},Ue.rest),Re.map((function(e,t){return Ze(e,t)})),je.map(tt)),He?(t=T.splitProps(w(Ge,void 0,void 0,e)),n=T.splitProps(P(Ge,void 0,void 0,e)),E().createElement(me,Y({className:t.className,style:Y({},t.style,{minWidth:We+"px"})},t.rest),E().createElement(ue,Y({className:S()(n.className),style:n.style},n.rest),ke.map(nt)))):null),z&&D?E().createElement("div",{className:"pagination-bottom"},rt(!1)):null,!Re.length&&E().createElement(ve,qe,T.normalizeComponent(j)),E().createElement(ge,Y({loading:X,loadingText:M},Je)));var t,n,a,s,c,d,g,f};return n?n(Ge,ot,this):ot()}}]),t}(function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),M(t,[{key:"getResolvedState",value:function(e,t){return R({},T.compactObject(this.state),T.compactObject(this.props),T.compactObject(t),T.compactObject(e))}},{key:"getDataModel",value:function(e,t){var n=this,r=e.columns,o=e.pivotBy,a=void 0===o?[]:o,s=e.data,i=e.resolveData,l=e.pivotIDKey,c=e.pivotValKey,u=e.subRowsKey,p=e.aggregatedKey,d=e.nestingLevelKey,m=e.originalKey,h=e.indexKey,g=e.groupedByPivotKey,f=e.SubComponent,v=!1;r.forEach((function(e){e.columns&&(v=!0)}));var b=[].concat(H(r)),y=r.find((function(e){return e.expander||e.columns&&e.columns.some((function(e){return e.expander}))}));y&&!y.expander&&(y=y.columns.find((function(e){return e.expander}))),f&&!y&&(b=[y={expander:!0}].concat(H(b)));var w=[],P=function(e,t){var r=function(e,t){var r=void 0;if((r=e.expander?R({},n.props.column,n.props.expanderDefaults,e):R({},n.props.column,e)).maxWidth<r.minWidth&&(r.minWidth=r.maxWidth),t&&(r.parentColumn=t),"string"==typeof r.accessor){r.id=r.id||r.accessor;var o=r.accessor;return r.accessor=function(e){return T.get(e,o)},r}if(r.accessor&&!r.id)throw console.warn(r),new Error("A column id is required if using a non-string accessor for column above.");return r.accessor||(r.accessor=function(){}),r}(e,t);return w.push(r),r},C=b.map((function(e){return e.columns?R({},e,{columns:e.columns.map((function(t){return P(t,e)}))}):P(e)})).slice(),x=[],S=(C=(C=C.map((function(e){if(e.columns){var t=e.columns.filter((function(e){return!(a.indexOf(e.id)>-1)&&T.getFirstDefined(e.show,!0)}));return R({},e,{columns:t})}return e}))).filter((function(e){return e.columns?e.columns.length:!(a.indexOf(e.id)>-1)&&T.getFirstDefined(e.show,!0)}))).findIndex((function(e){return e.pivot}));if(a.length){var k=[];a.forEach((function(e){var t=w.find((function(t){return t.id===e}));t&&k.push(t)}));var N=k.reduce((function(e,t){return e&&e===t.parentColumn&&t.parentColumn}),k[0].parentColumn),O=v&&N.Header,z={Header:O=O||function(){return E().createElement("strong",null,"Pivoted")},columns:k.map((function(e){return R({},n.props.pivotDefaults,e,{pivoted:!0})}))};S>=0?(z=R({},C[S],z),C.splice(S,1,z)):C.unshift(z)}var F=[],D=[],M=function(e,t){F.push(R({},n.props.column,t,{columns:e})),D=[]};C.forEach((function(e){if(e.columns)return x=x.concat(e.columns),D.length>0&&M(D),void M(e.columns,e);x.push(e),D.push(e)})),v&&D.length>0&&M(D);var A=function e(t,n){var r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=(j(r={},m,t),j(r,h,n),j(r,u,t[u]),j(r,d,o),r);return w.forEach((function(e){e.expander||(a[e.id]=e.accessor(t))})),a[u]&&(a[u]=a[u].map((function(t,n){return e(t,n,o+1)}))),a},$=this.resolvedData;this.resolvedData&&!t||($=i(s),this.resolvedData=$),$=$.map((function(e,t){return A(e,t)}));var B=x.filter((function(e){return!e.expander&&e.aggregate}));return a.length&&($=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(r===n.length)return t;var o=Object.entries(T.groupBy(t,n[r])).map((function(e){var t,o=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,a=void 0;try{for(var s,i=e[Symbol.iterator]();!(r=(s=i.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{!r&&i.return&&i.return()}finally{if(o)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}(e,2),a=o[0],s=o[1];return j(t={},l,n[r]),j(t,c,a),j(t,n[r],a),j(t,u,s),j(t,d,r),j(t,g,!0),t}));return o=o.map((function(t){var o,a=e(t[u],n,r+1);return R({},t,(j(o={},u,a),j(o,p,!0),o),function(e){var t={};return B.forEach((function(n){var r=e.map((function(e){return e[n.id]}));t[n.id]=n.aggregate(r,e)})),t}(a))})),o}($,a)),R({},e,{resolvedData:$,allVisibleColumns:x,headerGroups:F,allDecoratedColumns:w,hasHeaderGroups:v})}},{key:"getSortedData",value:function(e){var t=e.manual,n=e.sorted,r=e.filtered,o=e.defaultFilterMethod,a=e.resolvedData,s=e.allDecoratedColumns,i={};return s.filter((function(e){return e.sortMethod})).forEach((function(e){i[e.id]=e.sortMethod})),{sortedData:t?a:this.sortData(this.filterData(a,r,o,s),n,i)}}},{key:"fireFetchData",value:function(){var e=R({},this.getResolvedState(),{page:this.getStateOrProp("page"),pageSize:this.getStateOrProp("pageSize"),filtered:this.getStateOrProp("filtered")});this.props.onFetchData(e,this)}},{key:"getPropOrState",value:function(e){return T.getFirstDefined(this.props[e],this.state[e])}},{key:"getStateOrProp",value:function(e){return T.getFirstDefined(this.state[e],this.props[e])}},{key:"filterData",value:function(e,t,n,r){var o=this,a=e;return t.length&&(a=(a=t.reduce((function(e,t){var o=r.find((function(e){return e.id===t.id}));if(!o||!1===o.filterable)return e;var a=o.filterMethod||n;return o.filterAll?a(t,e,o):e.filter((function(e){return a(t,e,o)}))}),a)).map((function(e){return e[o.props.subRowsKey]?R({},e,j({},o.props.subRowsKey,o.filterData(e[o.props.subRowsKey],t,n,r))):e})).filter((function(e){return!e[o.props.subRowsKey]||e[o.props.subRowsKey].length>0}))),a}},{key:"sortData",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!t.length)return e;var o=(this.props.orderByMethod||T.orderBy)(e,t.map((function(e){return r[e.id]?function(t,n){return r[e.id](t[e.id],n[e.id],e.desc)}:function(t,r){return n.props.defaultSortMethod(t[e.id],r[e.id],e.desc)}})),t.map((function(e){return!e.desc})),this.props.indexKey);return o.forEach((function(e){e[n.props.subRowsKey]&&(e[n.props.subRowsKey]=n.sortData(e[n.props.subRowsKey],t,r))})),o}},{key:"getMinRows",value:function(){return T.getFirstDefined(this.props.minRows,this.getStateOrProp("pageSize"))}},{key:"onPageChange",value:function(e){var t=this.props,n=t.onPageChange,r=t.collapseOnPageChange,o={page:e};r&&(o.expanded={}),this.setStateWithData(o,(function(){return n&&n(e)}))}},{key:"onPageSizeChange",value:function(e){var t=this.props.onPageSizeChange,n=this.getResolvedState(),r=n.pageSize*n.page,o=Math.floor(r/e);this.setStateWithData({pageSize:e,page:o},(function(){return t&&t(e,o)}))}},{key:"sortColumn",value:function(e,t){var n=this.getResolvedState(),r=n.sorted,o=n.skipNextSort,a=n.defaultSortDesc,s=Object.prototype.hasOwnProperty.call(e,"defaultSortDesc")?e.defaultSortDesc:a,i=!s;if(o)this.setStateWithData({skipNextSort:!1});else{var l=this.props.onSortedChange,c=T.clone(r||[]).map((function(e){return e.desc=T.isSortingDesc(e),e}));if(T.isArray(e)){var u=c.findIndex((function(t){return t.id===e[0].id}));u>-1?(c[u].desc===i?t?c.splice(u,e.length):e.forEach((function(e,t){c[u+t].desc=s})):e.forEach((function(e,t){c[u+t].desc=i})),t||(c=c.slice(u,e.length))):c=t?c.concat(e.map((function(e){return{id:e.id,desc:s}}))):e.map((function(e){return{id:e.id,desc:s}}))}else{var p=c.findIndex((function(t){return t.id===e.id}));if(p>-1){var d=c[p];d.desc===i?t?c.splice(p,1):(d.desc=s,c=[d]):(d.desc=i,t||(c=[d]))}else t?c.push({id:e.id,desc:s}):c=[{id:e.id,desc:s}]}this.setStateWithData({page:!r.length&&c.length||!t?0:this.state.page,sorted:c},(function(){return l&&l(c,e,t)}))}}},{key:"filterColumn",value:function(e,t){var n=this.getResolvedState().filtered,r=this.props.onFilteredChange,o=(n||[]).filter((function(t){return t.id!==e.id}));""!==t&&o.push({id:e.id,value:t}),this.setStateWithData({filtered:o},(function(){return r&&r(o,e,t)}))}},{key:"resizeColumnStart",value:function(e,t,n){var r=this;e.stopPropagation();var o,a=e.target.parentElement.getBoundingClientRect().width;o=n?e.changedTouches[0].pageX:e.pageX,this.trapEvents=!0,this.setStateWithData({currentlyResizing:{id:t.id,startX:o,parentWidth:a}},(function(){n?(document.addEventListener("touchmove",r.resizeColumnMoving),document.addEventListener("touchcancel",r.resizeColumnEnd),document.addEventListener("touchend",r.resizeColumnEnd)):(document.addEventListener("mousemove",r.resizeColumnMoving),document.addEventListener("mouseup",r.resizeColumnEnd),document.addEventListener("mouseleave",r.resizeColumnEnd))}))}},{key:"resizeColumnMoving",value:function(e){e.stopPropagation();var t=this.props,n=t.onResizedChange,r=t.column,o=this.getResolvedState(),a=o.resized,s=o.currentlyResizing,i=o.columns.find((function(e){return e.accessor===s.id||e.id===s.id})),l=i&&null!=i.minResizeWidth?i.minResizeWidth:r.minResizeWidth,c=a.filter((function(e){return e.id!==s.id})),u=void 0;"touchmove"===e.type?u=e.changedTouches[0].pageX:"mousemove"===e.type&&(u=e.pageX);var p=Math.max(s.parentWidth+u-s.startX,l);c.push({id:s.id,value:p}),this.setStateWithData({resized:c},(function(){return n&&n(c,e)}))}},{key:"resizeColumnEnd",value:function(e){e.stopPropagation();var t="touchend"===e.type||"touchcancel"===e.type;t&&(document.removeEventListener("touchmove",this.resizeColumnMoving),document.removeEventListener("touchcancel",this.resizeColumnEnd),document.removeEventListener("touchend",this.resizeColumnEnd)),document.removeEventListener("mousemove",this.resizeColumnMoving),document.removeEventListener("mouseup",this.resizeColumnEnd),document.removeEventListener("mouseleave",this.resizeColumnEnd),t||this.setStateWithData({skipNextSort:!0,currentlyResizing:!1})}}]),t}(function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),D(t,[{key:"UNSAFE_componentWillMount",value:function(){this.setStateWithData(this.getDataModel(this.getResolvedState(),!0))}},{key:"componentDidMount",value:function(){this.fireFetchData()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e,t){var n=this.getResolvedState(),r=this.getResolvedState(e,t);["sorted","filtered","resized","expanded"].forEach((function(e){var t="default"+(e.charAt(0).toUpperCase()+e.slice(1));JSON.stringify(n[t])!==JSON.stringify(r[t])&&(r[e]=r[t])})),["sortable","filterable","resizable"].forEach((function(e){if(n[e]!==r[e]){var t=e.replace("able","")+"ed",o="default"+(t.charAt(0).toUpperCase()+t.slice(1));r[t]=r[o]}})),n.data===r.data&&n.columns===r.columns&&n.pivotBy===r.pivotBy&&n.sorted===r.sorted&&n.filtered===r.filtered||this.setStateWithData(this.getDataModel(r,n.data!==r.data))}},{key:"setStateWithData",value:function(e,t){var n=this,r=this.getResolvedState(),o=this.getResolvedState({},e),a=o.freezeWhenExpanded;if(o.frozen=!1,a)for(var s=Object.keys(o.expanded),i=0;i<s.length;i+=1)if(o.expanded[s[i]]){o.frozen=!0;break}return(r.frozen&&!o.frozen||r.sorted!==o.sorted||r.filtered!==o.filtered||r.showFilters!==o.showFilters||!o.frozen&&r.resolvedData!==o.resolvedData)&&((r.sorted!==o.sorted&&this.props.collapseOnSortingChange||r.filtered!==o.filtered||r.showFilters!==o.showFilters||r.sortedData&&!o.frozen&&r.resolvedData!==o.resolvedData&&this.props.collapseOnDataChange)&&(o.expanded={}),Object.assign(o,this.getSortedData(o))),r.filtered!==o.filtered&&(o.page=0),o.sortedData&&(o.pages=o.manual?o.pages:Math.ceil(o.sortedData.length/o.pageSize),o.page=o.manual?o.page:Math.max(o.page>=o.pages?o.pages-1:o.page,0)),this.setState(o,(function(){t&&t(),r.page===o.page&&r.pageSize===o.pageSize&&r.sorted===o.sorted&&r.filtered===o.filtered||n.fireFetchData()}))}}]),t}(y.Component)));Q.propTypes=J,Q.defaultProps=K;const Z=Q;var ee=p(7388);const te=["#E24D42","#1F78C1","#BA43A9","#705DA0","#466803","#508642","#447EBC","#C15C17","#890F02","#757575","#0A437C","#6D1F62","#584477","#629E51","#2F4F4F","#BF1B00","#806EB7","#8a2eb8","#699e00","#000000","#3F6833","#2F575E","#99440A","#E0752D","#0E4AB4","#58140C","#052B51","#511749","#3F2B5B"],ne=["#FF7368","#459EE7","#E069CF","#9683C6","#6C8E29","#76AC68","#6AA4E2","#E7823D","#AF3528","#9B9B9B","#3069A2","#934588","#7E6A9D","#88C477","#557575","#E54126","#A694DD","#B054DE","#8FC426","#262626","#658E59","#557D84","#BF6A30","#FF9B53","#3470DA","#7E3A32","#2B5177","#773D6F","#655181"],re=/^https?:\/\/.+/,oe=({tag:e,datasource:t,highlight:n,onClick:r})=>{const o=(0,ee.useStyles2)(ae),a=function(e){const t=function(e){let t=5381;for(let n=0;n<e.length;n++)t=(t<<5)+t+e.charCodeAt(n);return t}(e.toLowerCase());return{color:te[Math.abs(t%te.length)],borderColor:ne[Math.abs(t%ne.length)]}}(e.tag),s={background:a.color,borderColor:a.borderColor},i=re.test(e.value);let l=E().createElement(E().Fragment,null,e.value?`${e.tag}: ${e.value}`:`${e.tag}`);return i&&(l=E().createElement(ee.Tooltip,{placement:"top",content:e.value},E().createElement("a",{href:e.value,target:"_blank",rel:"noreferrer"},E().createElement(ee.Icon,{name:"link",className:o.icon}),e.tag))),E().createElement("span",{className:"label label-tag zbx-tag "+(n?"highlighted":""),style:s,onClick:n=>{r&&r(e,t,n.ctrlKey,n.shiftKey)}},l)},ae=e=>({icon:C.css`
    margin-right: ${e.spacing(.5)};
  `}),se=({status:e,className:t})=>{const n=(0,C.cx)(t,"icon-gf",{"icon-gf-critical":"critical"===e||"problem"===e||"warning"===e},{"icon-gf-online":"online"===e||"ok"===e});return E().createElement("i",{className:n})},ie=({icon:e,customClass:t})=>{const n=(0,C.cx)(t,"fa-icon-container");return E().createElement("span",{className:n},E().createElement("i",{className:`fa fa-${e}`}))},le=ie,ce=({icon:e,width:t,tooltip:n,className:r,children:o,onClick:a})=>{const s=(0,ee.useTheme)(),i=ue(s),l=(0,C.cx)("btn",i.button,C.css`
      width: ${t||3}rem;
    `,r);let c=E().createElement("button",{className:l,onClick:a},e&&E().createElement(ie,{icon:e,customClass:i.icon}),o);return n&&(c=E().createElement(ee.Tooltip,{placement:"bottom",content:n},c)),c},ue=(0,ee.stylesFactory)((e=>{const t=e.type===l.GrafanaThemeType.Light?"#497dc0":"#005f81",n=e.type===l.GrafanaThemeType.Light?"#456ba4":"#354f77";return{button:C.css`
      height: 2rem;
      background-image: none;
      background-color: ${t};
      border: 1px solid ${e.palette.gray1};
      border-radius: 1px;
      color: ${e.colors.text};

      i {
        vertical-align: middle;
      }

      &:hover {
        background-color: ${n};
      }
    `,icon:C.css`
      i {
        color: ${e.colors.text};
      }
    `}})),pe=({className:e,onClick:t})=>E().createElement(ce,{className:e,icon:"reply-all",tooltip:"Acknowledge problem",onClick:t}),de=({problem:e,panelId:t,range:n})=>E().createElement(ce,{icon:"compass",width:6,onClick:()=>me(e,t,n)},"Explore"),me=(e,t,n)=>{var r,o;let a={};if(1===(null===(r=e.items)||void 0===r?void 0:r.length)&&1===(null===(o=e.hosts)||void 0===o?void 0:o.length)){const t=e.items[0],n=e.hosts[0],r=f(t.name,t.key_);a={queryType:"0",group:{filter:"/.*/"},application:{filter:""},host:{filter:n.name},item:{filter:r}}}else{var s;a={queryType:"3",itemids:null===(s=e.items)||void 0===s?void 0:s.map((e=>e.itemid)).join(",")}}const i={datasource:e.datasource,context:"explore",originPanelId:t,range:n.raw,queries:[a]},c=JSON.stringify(i),u=l.urlUtil.renderUrl("/explore",{left:c});w.locationService.push(u)},he=({className:e,onClick:t})=>E().createElement(ce,{className:e,icon:"terminal",tooltip:"Execute script",onClick:t});var ge=p(2729),fe=p.n(ge);function ve(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function be(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){ve(e,t,n[t])}))}return e}const ye=E().createContext(w.config),Ee=ye.Consumer,we=({children:e})=>E().createElement(Ee,null,(t=>E().createElement(ee.ThemeContext.Provider,{value:(0,l.createTheme)({colors:{mode:w.config.bootData.user.lightTheme?"light":"dark"}})},e)));function Pe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Ce extends E().Component{renderModal(){const{component:e,props:t}=this.state;if(!e)return null;this.modalRoot.appendChild(this.modalNode);const n=E().createElement((e=>(e=>t=>E().createElement(ye.Provider,{value:w.config},E().createElement(e,be({},t))))((t=>E().createElement(we,null,E().createElement(e,be({},t))))))(e),t);return fe().createPortal(n,this.modalNode)}render(){const{children:e}=this.props,t=e;return E().createElement(E().Fragment,null,E().createElement(t,{showModal:this.showModal,hideModal:this.hideModal}),this.renderModal())}constructor(e){super(e),Pe(this,"modalRoot",document.body),Pe(this,"modalNode",document.createElement("div")),Pe(this,"showModal",((e,t)=>{this.setState({component:e,props:t})})),Pe(this,"hideModal",(()=>{this.modalRoot.removeChild(this.modalNode),this.setState({component:null,props:{}})})),this.state={component:null,props:{}}}}E().forwardRef((({data:e,isFocused:t,disabled:n,onClick:r,hideDescription:o},a)=>{const s=(0,ee.useTheme2)(),i=(0,ee.getSelectStyles)(s),l=(0,ee.useStyles2)(xe()),c=(0,C.cx)(i.option,l.menuOptionWrapper,t&&i.optionFocused,n&&l.menuOptionDisabled);return E().createElement("div",{ref:a,className:c,"aria-label":"Menu option",onClick:t=>{n||(t.preventDefault(),t.stopPropagation(),r(e))}},E().createElement("div",{className:(0,C.cx)(i.optionBody,l.menuOptionBody)},E().createElement("span",null,e.label||e.value),!o&&e.description&&E().createElement("div",{className:i.optionDescription},e.description)),e.description&&E().createElement(ee.Tooltip,{content:e.description},E().createElement(ee.Icon,{name:"info-circle",className:l.menuOptionInfoSign})))})).displayName="MenuOption";const xe=e=>t=>({menuWrapper:C.css`
      display: flex;
      max-height: 650px;
      position: absolute;
      z-index: ${t.zIndex.dropdown};
      overflow: hidden;
      min-width: auto;
    `,menu:C.css`
      min-width: ${t.spacing(e||0)};

      & > div {
        padding-top: ${t.spacing(1)};
      }
    `,menuLeft:C.css`
      right: 0;
      flex-direction: row-reverse;
    `,container:C.css`
      padding: ${t.spacing(1)};
      border: 1px ${t.colors.border.weak} solid;
      border-radius: ${t.shape.borderRadius(1)};
      background-color: ${t.colors.background.primary};
      z-index: ${t.zIndex.modal};
    `,menuOptionWrapper:C.css`
      padding: ${t.spacing(.5)};
    `,menuOptionBody:C.css`
      font-weight: ${t.typography.fontWeightRegular};
      padding: ${t.spacing(0,1.5,0,0)};
    `,menuOptionDisabled:C.css`
      color: ${t.colors.text.disabled};
      cursor: not-allowed;
    `,menuOptionInfoSign:C.css`
      color: ${t.colors.text.disabled};
    `});function Se(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const ke=[{value:0,label:"Not classified"},{value:1,label:"Information"},{value:2,label:"Warning"},{value:3,label:"Average"},{value:4,label:"High"},{value:5,label:"Disaster"}];class Ne extends y.PureComponent{renderActions(){const{canClose:e}=this.props;return[E().createElement(ee.Checkbox,{key:"ack",label:"Acknowledge",value:this.state.acknowledge,onChange:this.onAcknowledgeToggle}),E().createElement(ee.Checkbox,{key:"change-severity",label:"Change severity",description:"",value:this.state.changeSeverity,onChange:this.onChangeSeverityToggle}),this.state.changeSeverity&&E().createElement(ee.RadioButtonGroup,{key:"severity",size:"sm",options:ke,value:this.state.selectedSeverity,onChange:this.onChangeSelectedSeverity}),e&&E().createElement(ee.Checkbox,{key:"close",label:"Close problem",disabled:!e,value:this.state.closeProblem,onChange:this.onCloseProblemToggle})].filter((e=>e))}render(){const{theme:e}=this.props,t=Te(e);return E().createElement(ee.Modal,{isOpen:!0,onDismiss:this.dismiss,className:t.modal,title:E().createElement("div",{className:t.modalHeaderTitle},this.state.loading?E().createElement(ee.Spinner,{size:18}):E().createElement(ie,{icon:"reply-all"}),"Acknowledge Problem")},E().createElement("div",{className:t.inputGroup},E().createElement(ee.TextArea,{className:this.state.error&&t.input,type:"text",name:"message",placeholder:"Message",autoComplete:"off",autoFocus:!0,value:this.state.value,onChange:this.handleChange,onKeyDown:this.handleKeyPress}),E().createElement("small",{className:t.inputHint},"Press Enter to submit"),this.state.error&&E().createElement("small",{className:t.inputError},this.state.errorMessage)),E().createElement(ee.VerticalGroup,null,this.renderActions()),this.state.ackError&&E().createElement("span",{className:t.ackError},this.state.ackError),E().createElement(ee.ButtonGroup,{className:t.buttonGroup},E().createElement(ee.Button,{variant:"primary",onClick:this.submit},"Update"),E().createElement(ee.Button,{variant:"secondary",onClick:this.dismiss},"Cancel")))}constructor(e){super(e),Se(this,"handleChange",(e=>{this.setState({value:e.target.value,error:!1})})),Se(this,"handleKeyPress",(e=>{13===e.which||"Enter"===e.key||27!==e.which&&"Escape"!==e.key||this.dismiss()})),Se(this,"handleBackdropClick",(()=>{this.dismiss()})),Se(this,"onAcknowledgeToggle",(()=>{this.setState({acknowledge:!this.state.acknowledge,error:!1})})),Se(this,"onChangeSeverityToggle",(()=>{this.setState({changeSeverity:!this.state.changeSeverity,error:!1})})),Se(this,"onCloseProblemToggle",(()=>{this.setState({closeProblem:!this.state.closeProblem,error:!1})})),Se(this,"onChangeSelectedSeverity",(e=>{this.setState({selectedSeverity:e})})),Se(this,"dismiss",(()=>{this.setState({value:"",error:!1,errorMessage:"",ackError:"",loading:!1}),this.props.onDismiss()})),Se(this,"submit",(()=>{const{acknowledge:e,changeSeverity:t,closeProblem:n}=this.state,r=e||t||n;if(!this.state.value&&!r)return this.setState({error:!0,errorMessage:"Enter message text or select an action"});this.setState({ackError:"",loading:!0});const o={message:this.state.value};let a=4;this.state.acknowledge&&(a+=2),this.state.changeSeverity&&(a+=8,o.severity=this.state.selectedSeverity),this.state.closeProblem&&(a+=1),o.action=a,this.props.onSubmit(o).then((()=>{this.dismiss()})).catch((e=>{var t,n;const r=(null===(t=e.data)||void 0===t?void 0:t.message)||(null===(n=e.data)||void 0===n?void 0:n.error)||e.data||e.statusText||"";this.setState({ackError:r,loading:!1})}))})),this.state={value:"",error:!1,errorMessage:"",ackError:"",acknowledge:!1,closeProblem:!1,changeSeverity:!1,selectedSeverity:e.severity||0,loading:!1}}}Se(Ne,"defaultProps",{withBackdrop:!0});const Te=(0,ee.stylesFactory)((e=>{const t=e.palette.red;return{modal:C.css`
      width: 500px;
    `,modalHeaderTitle:C.css`
      font-size: ${e.typography.heading.h3};
      padding-top: ${e.spacing.sm};
      margin: 0 ${e.spacing.md};
      display: flex;
    `,inputGroup:C.css`
      margin-bottom: 16px;
    `,input:C.css`
      border-color: ${t};
      border-radius: 2px;
      outline-offset: 2px;
      box-shadow:
        0 0 0 2px ${e.colors.bg1},
        0 0 0px 4px ${t};
    `,inputHint:C.css`
      display: inherit;
      float: right;
      color: ${e.colors.textWeak};
    `,inputError:C.css`
      float: left;
      color: ${t};
    `,ackError:C.css`
      color: ${t};
    `,buttonGroup:C.css`
      justify-content: center;
      gap: ${e.spacing.sm};
      margin-top: ${e.spacing.md};
    `}})),Oe=(0,ee.withTheme)(Ne);function ze(e){const{acknowledges:t}=e;return E().createElement("div",{className:"problem-ack-list"},E().createElement("div",{className:"problem-ack-col problem-ack-time"},t.map((e=>E().createElement("span",{key:e.acknowledgeid,className:"problem-ack-time"},e.time)))),E().createElement("div",{className:"problem-ack-col problem-ack-user"},t.map((e=>E().createElement("span",{key:e.acknowledgeid,className:"problem-ack-user"},function(e){return e.name||e.surname?`${e.name} ${e.surname}`.trim():e.user}(e))))),E().createElement("div",{className:"problem-ack-col problem-ack-message"},t.map((e=>E().createElement("span",{key:e.acknowledgeid,className:"problem-ack-message"},e.message)))))}function Fe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function De(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Fe(e,t,n[t])}))}return e}const Re=Math.round(9.6);class Me extends y.PureComponent{componentDidUpdate(e,t){if(this.rootRef&&t.width!==this.rootRef.clientWidth){const e=this.rootRef.clientWidth;this.setState({width:e})}}getEventDuration(e,t){return 1e3*Math.abs(Number(this.sortedEvents[e].clock)-Number(this.sortedEvents[t].clock))}sortEvents(){const e=u().sortBy(this.props.events,(e=>Number(e.clock)));return this.sortedEvents=e,e}getEventAcks(e){const t=[];for(const n of e)if(n.acknowledges)for(const e of n.acknowledges)t.push(e);return u().sortBy(t,(e=>Number(e.clock)))}render(){if(!this.rootRef)return E().createElement("div",{className:"event-timeline",ref:this.setRootRef});const{timeRange:e,eventPointSize:t,eventRegionHeight:n}=this.props,r=this.sortEvents(),o=this.getEventAcks(r),a=this.state.width+t,s=Math.round(2.5*t),i=a-t,l=Math.round(t/2),c=n/2,u=Math.round(s/2-t/2);return E().createElement("div",{className:"event-timeline",ref:this.setRootRef,style:{transform:`translate(${-l}px, 0)`}},E().createElement(He,{className:"timeline-info-container",event:this.state.highlightedEvent,eventInfo:this.state.eventInfo,show:this.state.showEventInfo,left:l}),E().createElement("svg",{className:"event-timeline-canvas",viewBox:`0 0 ${a} ${s}`},E().createElement("defs",null,E().createElement(je,null)),E().createElement("g",{className:"event-timeline-group",transform:`translate(${l}, ${u})`},E().createElement("g",{className:"event-timeline-regions",filter:"url(#boxShadow)"},E().createElement(Ae,{events:r,timeRange:e,width:i,height:n,highlightedRegion:this.state.highlightedRegion})),E().createElement("g",{className:"timeline-acknowledges",transform:`translate(0, ${c})`},E().createElement(_e,{acknowledges:o,timeRange:e,width:i,size:t,onHighlight:this.handleAckHighlight,onUnHighlight:this.handleAckUnHighlight})),E().createElement("g",{className:"timeline-points",transform:`translate(0, ${c})`},E().createElement($e,{events:r,timeRange:e,width:i,pointSize:t,onPointHighlight:this.handlePointHighlight,onPointUnHighlight:this.handlePointUnHighlight})))))}constructor(e){super(e),Fe(this,"rootRef",void 0),Fe(this,"sortedEvents",void 0),Fe(this,"setRootRef",(e=>{this.rootRef=e;const t=e&&e.clientWidth||0;this.setState({width:t})})),Fe(this,"handlePointHighlight",((e,t)=>{const n=this.sortedEvents[e],r=this.getRegionToHighlight(e);let o;void 0!==t&&(o=this.getEventDuration(e,t)),this.setState({highlightedEvent:n,showEventInfo:!0,highlightedRegion:r,eventInfo:{duration:o}})})),Fe(this,"handlePointUnHighlight",(()=>{this.setState({showEventInfo:!1,highlightedRegion:null})})),Fe(this,"handleAckHighlight",((e,t)=>{this.setState({showEventInfo:!0,eventInfo:{timestamp:Number(e.clock),message:e.message}})})),Fe(this,"handleAckUnHighlight",(()=>{this.setState({showEventInfo:!1})})),Fe(this,"showEventInfo",(e=>{this.setState({highlightedEvent:e,showEventInfo:!0})})),Fe(this,"hideEventInfo",(()=>{this.setState({showEventInfo:!1})})),Fe(this,"getRegionToHighlight",(e=>"1"===this.sortedEvents[e].value?e+1:e)),this.state={width:0,highlightedEvent:null,highlightedRegion:null,showEventInfo:!1,eventInfo:{}}}}function je(){return E().createElement(E().Fragment,null,E().createElement("filter",{id:"dropShadow",x:"-50%",y:"-50%",width:"200%",height:"200%"},E().createElement("feGaussianBlur",{in:"SourceAlpha",stdDeviation:"2"}),E().createElement("feOffset",{dx:"1",dy:"1"}),E().createElement("feMerge",null,E().createElement("feMergeNode",null),E().createElement("feMergeNode",{in:"SourceGraphic"}))),E().createElement("filter",{id:"boxShadow",x:"-50%",y:"-50%",width:"200%",height:"200%"},E().createElement("feGaussianBlur",{in:"SourceAlpha",stdDeviation:"1"}),E().createElement("feComponentTransfer",null,E().createElement("feFuncA",{type:"linear",slope:"0.7"})),E().createElement("feOffset",{dx:"1",dy:"1"}),E().createElement("feMerge",null,E().createElement("feMergeNode",null),E().createElement("feMergeNode",{in:"SourceGraphic"}))),E().createElement("filter",{id:"glowShadow",x:"-50%",y:"-50%",width:"200%",height:"200%"},E().createElement("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"2"}),E().createElement("feMerge",null,E().createElement("feMergeNode",null),E().createElement("feMergeNode",{in:"SourceGraphic"}))),E().createElement("filter",{id:"timelinePointBlur",x:"-50%",y:"-50%",width:"200%",height:"200%"},E().createElement("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"2",result:"blurOut"})))}Fe(Me,"defaultProps",{okColor:"rgb(56, 189, 113)",problemColor:"rgb(215, 0, 0)",eventRegionHeight:Re,eventPointSize:16});class He extends y.PureComponent{render(){const{event:e,eventInfo:t,show:n,className:r,left:o}=this.props;let a,s;if(e){const t=h()(1e3*Number(e.clock)).format("HH:mm:ss");a=[E().createElement("span",{key:"ts",className:"event-timestamp"},E().createElement("span",{className:"event-timestamp-label"},"Time: "),E().createElement("span",{className:"event-timestamp-value"},t))]}if(t&&t.duration){const e=t.duration,n=h().utc(e).format("HH:mm:ss");s=E().createElement("span",{key:"duration",className:"event-timestamp"},E().createElement("span",{className:"event-timestamp-label"},"Duration: "),E().createElement("span",{className:"event-timestamp-value"},n))}if(t&&t.timestamp){const e=h()(1e3*t.timestamp).format("HH:mm:ss");a=[E().createElement("span",{key:"ts",className:"event-timestamp"},E().createElement("span",{className:"event-timestamp-label"},"Time: "),E().createElement("span",{className:"event-timestamp-value"},e))]}const i={left:o};return n||(i.opacity=0),E().createElement("div",{className:r,style:i},E().createElement("div",null,a),E().createElement("div",null,s),t&&t.message&&E().createElement("div",null,E().createElement("span",{key:"duration",className:"event-timestamp"},E().createElement("span",{className:"event-timestamp-label"},"Message: "),E().createElement("span",{className:"event-timestamp-value"},t.message))))}}Fe(He,"defaultProps",{left:0,className:"",show:!1});class Ae extends y.PureComponent{render(){const{events:e,timeRange:t,width:n,height:r,highlightedRegion:o}=this.props,a=t.from.unix(),s=t.to.unix(),i=s-a;let l;if(e.length){const t=((e.length?Number(e[0].clock):s)-a)/i,c=Math.round(t*n),u=0===o,p=`problem-event-region ${"problem-event--"+("1"!==e[0].value?"problem":"ok")} ${u?"highlighted":""}`,d={x:0,y:0,width:c,height:r};l=E().createElement("rect",De({key:"0",className:p},d))}const c=e.map(((t,l)=>{const c=Number(t.clock),u=((l<e.length-1?Number(e[l+1].clock):s)-c)/i,p=Math.round(u*n),d=Math.round((c-a)/i*n),m=o&&o-1===l,h=`problem-event-region ${"problem-event--"+("1"===t.value?"problem":"ok")} ${m?"highlighted":""}`,g={x:d,y:0,width:p,height:r};return E().createElement("rect",De({key:`${t.eventid}-${l}`,className:h},g))}));return E().createElement(E().Fragment,null,l,c)}}Fe(Ae,"defaultProps",{highlightedRegion:null});class $e extends y.PureComponent{getRegionEvents(e){const t=this.props.events,n=t[e];if("1"===n.value&&e<t.length){for(let n=e;n<t.length;n++)if("0"===t[n].value)return[e,n]}else if("0"===n.value&&e>0){let n=null;for(let r=e-1;r>=0&&"1"===t[r].value;r--)n=r;if(null!==n)return[e,n]}return[e]}render(){const{events:e,timeRange:t,width:n,pointSize:r}=this.props,o=t.from.unix(),a=t.to.unix()-o,s=r/2,i=e.map(((e,t)=>{const r=Number(e.clock),i=Math.round((r-o)/a*n-s),l="problem-event-item problem-event--"+("1"===e.value?"problem":"ok"),c=-1!==this.state.highlighted.indexOf(t);return E().createElement(Be,{key:`${e.eventid}-${t}`,className:l,x:i,r:s,highlighted:c,onPointHighlight:this.highlightPoint(t),onPointUnHighlight:this.unHighlightPoint(t)})}));return this.state.order.length?this.state.order.map((e=>i[e])):i}constructor(e){super(e),Fe(this,"bringToFront",((e,t=!1)=>{const{events:n}=this.props;let r=n.map(((e,t)=>t));r=We(r,e);const o=t?e:null;this.setState({order:r,highlighted:o})})),Fe(this,"highlightPoint",(e=>()=>{let t=[e];if(this.props.onPointHighlight)if(this.props.highlightRegion){t=this.getRegionEvents(e);const n=2===t.length?t[1]:void 0;this.props.onPointHighlight(e,n)}else this.props.onPointHighlight(e);this.bringToFront(t,!0)})),Fe(this,"unHighlightPoint",(e=>()=>{this.props.onPointUnHighlight&&this.props.onPointUnHighlight();const e=this.props.events.map(((e,t)=>t));this.setState({order:e,highlighted:[]})})),this.state={order:[],highlighted:[]}}}Fe($e,"defaultProps",{highlightRegion:!0});class Be extends y.PureComponent{componentDidUpdate(e){e.highlighted!==this.props.highlighted&&this.setState({highlighted:this.props.highlighted})}render(){const{x:e}=this.props,t=this.state.highlighted?Math.round(1.1*this.props.r):this.props.r,n=e+this.props.r,r=Math.round(.6*t),o=`${this.props.className||""} ${this.state.highlighted?"highlighted":""}`;return E().createElement("g",{className:o,transform:`translate(${n}, 0)`,filter:"url(#dropShadow)",onMouseOver:this.handleMouseOver,onMouseLeave:this.handleMouseLeave},E().createElement("circle",{cx:0,cy:0,r:t,className:"point-border"}),E().createElement("circle",{cx:0,cy:0,r,className:"point-core"}))}constructor(e){super(e),Fe(this,"handleMouseOver",(()=>{this.props.onPointHighlight&&this.props.onPointHighlight()})),Fe(this,"handleMouseLeave",(()=>{this.props.onPointUnHighlight&&this.props.onPointUnHighlight()})),this.state={highlighted:!1}}}class _e extends y.PureComponent{render(){const{acknowledges:e,timeRange:t,width:n,size:r}=this.props,o=t.from.unix(),a=t.to.unix()-o,s=r/2,i=e.map(((e,t)=>{const r=Number(e.clock),i=Math.round((r-o)/a*n-s),l=this.state.highlighted===t;return E().createElement(Ie,{key:`${e.eventid}-${t}`,x:i,r:s,highlighted:l,onHighlight:this.handleHighlight(t),onUnHighlight:this.handleUnHighlight})}));return this.state.order.length?this.state.order.map((e=>i[e])):i}constructor(e){super(e),Fe(this,"handleHighlight",(e=>()=>{if(this.props.onHighlight){const t=this.props.acknowledges[e];this.props.onHighlight(t,e)}this.bringToFront(e,!0)})),Fe(this,"handleUnHighlight",(()=>{this.props.onUnHighlight&&this.props.onUnHighlight();const e=this.props.acknowledges.map(((e,t)=>t));this.setState({order:e,highlighted:null})})),Fe(this,"bringToFront",((e,t=!1)=>{const{acknowledges:n}=this.props;let r=n.map(((e,t)=>t));r=We(r,[e]);const o=t?e:null;this.setState({order:r,highlighted:o})})),this.state={order:[],highlighted:null}}}class Ie extends y.PureComponent{componentDidUpdate(e){e.highlighted!==this.props.highlighted&&this.setState({highlighted:this.props.highlighted})}render(){const{x:e}=this.props,t=this.state.highlighted?Math.round(1.1*this.props.r):this.props.r,n=e+this.props.r,r=Math.round(.6*t),o="problem-event-ack "+(this.state.highlighted?"highlighted":"");return E().createElement("g",{className:o,transform:`translate(${n}, 0)`,filter:"url(#dropShadow)",onMouseOver:this.handleHighlight,onMouseLeave:this.handleUnHighlight},E().createElement("circle",{cx:0,cy:0,r:t,className:"point-border"}),E().createElement("circle",{cx:0,cy:0,r,className:"point-core"}))}constructor(e){super(e),Fe(this,"handleHighlight",(()=>{this.props.onHighlight&&this.props.onHighlight()})),Fe(this,"handleUnHighlight",(()=>{this.props.onUnHighlight&&this.props.onUnHighlight()})),this.state={highlighted:!1}}}function We(e,t){const n=u().pullAt(e,t);return n.reverse(),e.push(...n),e}function Le(e,t,n,r,o,a,s){try{var i=e[a](s),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(r,o)}function Ge(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Ke extends y.PureComponent{componentDidMount(){var e,t=this;return(e=function*(){const e=yield t.props.getScripts();t.scripts=e;const n=e.map((e=>({value:e.scriptid,label:e.name,description:e.description||e.command}))),r=(null==n?void 0:n.length)?n[0]:null,o=e.find((e=>r.value===e.scriptid));t.setState({scriptOptions:n,selectedScript:r,script:o})},function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function s(e){Le(a,r,o,s,i,"next",e)}function i(e){Le(a,r,o,s,i,"throw",e)}s(void 0)}))})()}render(){const{theme:e}=this.props,{scriptOptions:t,selectedScript:n,script:r,result:o,selectError:a,errorMessage:s,error:i}=this.state,l=Ve(e);return E().createElement(ee.Modal,{isOpen:!0,onDismiss:this.dismiss,className:l.modal,title:E().createElement("div",{className:l.modalHeaderTitle},this.state.loading?E().createElement(ee.Spinner,{size:18}):E().createElement(ie,{icon:"terminal"}),"Execute script")},E().createElement(ee.Select,{options:t,value:n,onChange:this.onChangeSelectedScript}),a&&E().createElement("small",{className:l.inputError},a),E().createElement("div",{className:l.scriptCommandContainer},r&&E().createElement("small",{className:l.scriptCommand},r.command)),E().createElement("div",{className:l.resultContainer},o&&E().createElement("span",{className:l.execResult},o),i&&E().createElement("span",{className:l.execError},s)),E().createElement(ee.ButtonGroup,{className:l.buttonGroup},E().createElement(ee.Button,{variant:"primary",onClick:this.submit},"Execute"),E().createElement(ee.Button,{variant:"secondary",onClick:this.dismiss},"Cancel")))}constructor(e){super(e),Ge(this,"scripts",void 0),Ge(this,"onChangeSelectedScript",(e=>{const t=this.scripts.find((t=>e.value===t.scriptid));this.setState({selectedScript:e,script:t,errorMessage:"",loading:!1,result:""})})),Ge(this,"dismiss",(()=>{this.setState({selectedScript:null,error:!1,errorMessage:"",selectError:"",loading:!1}),this.props.onDismiss()})),Ge(this,"submit",(()=>{const{selectedScript:e}=this.state;if(!e)return this.setState({selectError:"Select a script to execute."});this.setState({errorMessage:"",loading:!0,result:""});const t={scriptid:e.value};this.props.onSubmit(t).then((e=>{const t=this.formatResult((null==e?void 0:e.value)||"");"success"===(null==e?void 0:e.response)?this.setState({result:t,loading:!1}):this.setState({error:!0,errorMessage:t,loading:!1})})).catch((e=>{var t,n;let r=(null===(t=e.data)||void 0===t?void 0:t.message)||(null===(n=e.data)||void 0===n?void 0:n.error)||e.data||e.statusText||"";r=this.formatResult(r),this.setState({error:!0,loading:!1,errorMessage:r})}))})),Ge(this,"formatResult",(e=>{const t=e.split("\n").map(((e,t)=>E().createElement("p",{key:t},e)));return E().createElement(E().Fragment,null,t)})),this.state={error:!1,errorMessage:"",selectError:"",selectedScript:null,result:"",loading:!1,scriptOptions:[],script:null}}}const Ve=(0,ee.stylesFactory)((e=>{const t=e.palette.red;return{modal:C.css`
      width: 600px;
    `,modalHeaderTitle:C.css`
      font-size: ${e.typography.heading.h3};
      padding-top: ${e.spacing.sm};
      margin: 0 ${e.spacing.md};
      display: flex;
    `,input:C.css`
      border-color: ${t};
      border-radius: 2px;
      outline-offset: 2px;
      box-shadow:
        0 0 0 2px ${e.colors.bg1},
        0 0 0px 4px ${t};
    `,scriptCommandContainer:C.css`
      margin-bottom: ${e.spacing.md};
    `,scriptCommand:C.css`
      color: ${e.colors.textWeak};
      text-align: left;
      font-family: ${e.typography.fontFamily.monospace};
    `,inputHint:C.css`
      display: inherit;
      float: right;
      color: ${e.colors.textWeak};
    `,inputError:C.css`
      float: left;
      color: ${t};
    `,resultContainer:C.css`
      min-height: 50px;
      font-family: ${e.typography.fontFamily.monospace};
      font-size: ${e.typography.size.sm};
      p {
        font-size: ${e.typography.size.sm};
        margin-bottom: 0px;
      }
    `,execResult:C.css``,execError:C.css`
      color: ${t};
    `,buttonGroup:C.css`
      justify-content: center;
      gap: ${e.spacing.sm};
      margin-top: ${e.spacing.md};
    `}})),Ue=(0,ee.withTheme)(Ke);function Je(e){const{problem:t,alerts:n,className:r}=e,o="1"===t.type,a=t.url&&""!==t.url,s=t.maintenance,i="1"===t.manual_close,l=t.error&&""!==t.error,c="1"===t.state,u="1"===t.correlation_mode,p=n&&0!==n.length,d=p?n[0].message:"";return E().createElement("div",{className:`problem-statusbar ${r||""}`},E().createElement(qe,{icon:"wrench",fired:s,tooltip:"Host maintenance"}),E().createElement(qe,{icon:"globe",fired:a,link:a&&t.url,tooltip:"External link"}),E().createElement(qe,{icon:"bullhorn",fired:o,tooltip:"Trigger generates multiple problem events"}),E().createElement(qe,{icon:"tag",fired:u,tooltip:`OK event closes problems matched to tag: ${t.correlation_tag}`}),E().createElement(qe,{icon:"circle-o-notch",fired:p,tooltip:d}),E().createElement(qe,{icon:"question-circle",fired:c,tooltip:"Current trigger state is unknown"}),E().createElement(qe,{icon:"warning",fired:l,tooltip:t.error}),E().createElement(qe,{icon:"window-close-o",fired:i,tooltip:"Manual close problem"}))}function qe(e){const{fired:t,icon:n,link:r,tooltip:o}=e;let a=E().createElement("div",{className:"problem-statusbar-item "+(t?"fired":"muted")},E().createElement(le,{icon:n}));return o&&t&&(a=E().createElement(ee.Tooltip,{placement:"bottom",content:o},a)),r?E().createElement("a",{href:r,target:"_blank",rel:"noreferrer"},a):a}const Ye=({items:e})=>{const t=(0,ee.useStyles2)(Qe);return E().createElement("div",{className:t.itemsRow},e.length>1?e.map((e=>E().createElement(Xe,{item:e,key:e.itemid,showName:!0}))):E().createElement(Xe,{item:e[0]}))},Xe=({item:e,showName:t})=>{const n=(0,ee.useStyles2)(Qe),r=f(e.name,e.key_);return E().createElement("div",{className:n.itemContainer},E().createElement(ie,{icon:"thermometer-three-quarters"}),t&&E().createElement("span",{className:n.itemName},e.name,": "),E().createElement(ee.Tooltip,{placement:"top-start",content:()=>E().createElement(E().Fragment,null,r,E().createElement("br",null),e.lastvalue)},E().createElement("span",null,e.lastvalue)))},Qe=e=>({itemContainer:C.css`
    display: flex;
  `,itemName:C.css`
    color: ${e.colors.text.secondary};
  `,itemsRow:C.css`
    overflow: hidden;
  `}),Ze=({hosts:e})=>{const t=(0,ee.useStyles2)(tt);return E().createElement(E().Fragment,null,e.map((e=>E().createElement("div",{className:t.hostContainer,key:e.hostid},E().createElement(ie,{icon:"server"}),E().createElement("span",null,e.name)))))},et=({hosts:e})=>{const t=(0,ee.useStyles2)(tt);return E().createElement(E().Fragment,null,E().createElement("span",{className:t.label},"Host description: "),e.map(((e,t)=>E().createElement("span",{key:`${e.hostid}-${t}`},e.description))))},tt=e=>({hostContainer:C.css`
    margin-bottom: ${e.spacing(.2)};
  `,label:C.css`
    color: ${e.colors.text.secondary};
  `}),nt=({groups:e})=>{const t=(0,ee.useStyles2)(rt);return E().createElement(E().Fragment,null,e.map((e=>E().createElement("div",{className:t.groupContainer,key:e.groupid},E().createElement(ie,{icon:"folder"}),E().createElement("span",null,e.name)))))},rt=e=>({groupContainer:C.css`
    margin-bottom: ${e.spacing(.2)};
  `}),ot=({problem:e})=>{const t=(0,ee.useStyles2)(at);return E().createElement(E().Fragment,null,E().createElement(ee.Tooltip,{placement:"right",content:e.expression},E().createElement("span",{className:t.label},"Expression: ")),E().createElement("span",{className:t.expression},e.expression))},at=e=>({label:C.css`
    color: ${e.colors.text.secondary};
  `,expression:C.css`
    font-family: ${e.typography.fontFamilyMonospace};
  `});function st(e,t,n,r,o,a,s){try{var i=e[a](s),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(r,o)}function it(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function s(e){st(a,r,o,s,i,"next",e)}function i(e){st(a,r,o,s,i,"throw",e)}s(void 0)}))}}const lt=({original:e,rootWidth:t,timeRange:n,showTimeline:r,panelId:o,allowDangerousHTML:a,getProblemAlerts:s,getProblemEvents:i,getScripts:l,onExecuteScript:c,onProblemAck:u,onTagClick:p})=>{var d;const[m,g]=(0,y.useState)([]),[f,v]=(0,y.useState)([]),[b,P]=(0,y.useState)(!1);(0,y.useEffect)((()=>{r&&C(),S(),requestAnimationFrame((()=>{P(!0)}))}),[]);const C=(x=it((function*(){const t=e,n=yield i(t);g(n)})),function(){return x.apply(this,arguments)});var x;const S=function(){var t=it((function*(){const t=e,n=yield s(t);v(n)}));return function(){return t.apply(this,arguments)}}(),k=(e,t,n,r)=>{p&&p(e,t,n,r)},N=t=>u(e,t),T=()=>l(e),O=t=>c(e,t.scriptid),z=e,F=b?"show":"",D=t>1200,R=t<800||z.acknowledges&&D&&t<1400,M=h().unix(z.timestamp).fromNow(!0),j=z.acknowledges&&0!==z.acknowledges.length,H=Number(z.severity),A=(0,ee.useStyles2)(ct);let $=e.datasource;(null===(d=e.datasource)||void 0===d?void 0:d.uid)&&($=(0,w.getDataSourceSrv)().getInstanceSettings(e.datasource.uid).name);const B=a?E().createElement("span",{dangerouslySetInnerHTML:{__html:z.comments}}):E().createElement("span",null,z.comments);return E().createElement("div",{className:`problem-details-container ${F}`},E().createElement("div",{className:"problem-details-body"},E().createElement("div",{className:A.problemDetails},E().createElement("div",{className:"problem-details-head"},E().createElement("div",{className:"problem-actions-left"},E().createElement(de,{problem:z,panelId:o,range:n})),z.showAckButton&&E().createElement("div",{className:"problem-actions"},E().createElement(Ce,null,(({showModal:e,hideModal:t})=>E().createElement(he,{className:"problem-action-button",onClick:()=>{e(Ue,{getScripts:T,onSubmit:O,onDismiss:t})}}))),E().createElement(Ce,null,(({showModal:e,hideModal:t})=>E().createElement(pe,{className:"problem-action-button",onClick:()=>{e(Oe,{canClose:"1"===z.manual_close,severity:H,onSubmit:N,onDismiss:t})}})))),E().createElement(Je,{problem:z,alerts:f,className:R&&"compact"})),E().createElement("div",{className:"problem-details-row"},E().createElement("div",{className:"problem-value-container"},E().createElement("div",{className:"problem-age"},E().createElement(ie,{icon:"clock-o"}),E().createElement("span",null,M)),z.items&&E().createElement(Ye,{items:z.items}))),z.comments&&E().createElement("div",{className:"problem-description-row"},E().createElement("div",{className:A.problemDescription},E().createElement(ee.Tooltip,{placement:"right",content:B},E().createElement("span",{className:"description-label"},"Description: ")),B)),z.items&&E().createElement("div",null,E().createElement(ot,{problem:z})),z.hosts&&E().createElement("div",null,E().createElement(et,{hosts:z.hosts})),z.tags&&z.tags.length>0&&E().createElement("div",{className:"problem-tags"},z.tags&&z.tags.map((e=>E().createElement(oe,{key:e.tag+e.value,tag:e,datasource:z.datasource,highlight:e.tag===z.correlation_tag,onClick:k})))),r&&m.length>0&&E().createElement(Me,{events:m,timeRange:n}),j&&!D&&E().createElement("div",{className:"problem-ack-container"},E().createElement("h6",null,E().createElement(ie,{icon:"reply-all"})," Acknowledges"),E().createElement(ze,{acknowledges:z.acknowledges}))),j&&D&&E().createElement("div",{className:"problem-details-middle"},E().createElement("div",{className:"problem-ack-container"},E().createElement("h6",null,E().createElement(ie,{icon:"reply-all"})," Acknowledges"),E().createElement(ze,{acknowledges:z.acknowledges}))),E().createElement("div",{className:"problem-details-right"},E().createElement("div",{className:"problem-details-right-item"},E().createElement(ie,{icon:"database"}),E().createElement("span",null,$)),z.proxy&&E().createElement("div",{className:"problem-details-right-item"},E().createElement(ie,{icon:"cloud"}),E().createElement("span",null,z.proxy)),z.groups&&E().createElement(nt,{groups:z.groups}),z.hosts&&E().createElement(Ze,{hosts:z.hosts}))))},ct=e=>({problemDetails:C.css`
    position: relative;
    flex: 10 1 auto;
    // padding: 0.5rem 1rem 0.5rem 1.2rem;
    padding: ${e.spacing(.5)} ${e.spacing(1)} ${e.spacing(.5)} ${e.spacing(1.2)};
    display: flex;
    flex-direction: column;
    // white-space: pre-line;
    font-size: ${e.typography.bodySmall.fontSize};
  `,problemDescription:C.css`
    position: relative;
    max-height: 6rem;
    min-height: 3rem;
    overflow: hidden;

    &:after {
      content: '';
      text-align: right;
      position: inherit;
      bottom: 0;
      right: 0;
      width: 70%;
      height: 1.5rem;
      background: linear-gradient(to right, rgba(0, 0, 0, 0), ${e.colors.background.canvas} 50%);
    }
  `}),ut=(0,ee.stylesFactory)((e=>({countLabel:C.css`
      font-size: ${e.typography.size.sm};
    `}))),pt=e=>{var t,n;const r=e.original,o=(0,ee.useTheme)(),a=ut(o);return E().createElement("div",null,(null===(t=r.acknowledges)||void 0===t?void 0:t.length)>0&&E().createElement(E().Fragment,null,E().createElement(ie,{icon:"comments"}),E().createElement("span",{className:a.countLabel}," (",null===(n=r.acknowledges)||void 0===n?void 0:n.length,")")))};function dt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function mt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){dt(e,t,n[t])}))}return e}function ht(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}class gt extends y.PureComponent{buildColumns(){const e=[],t=this.props.panelOptions,n=t.highlightNewEvents&&t.highlightNewerThan,r=[{Header:"Host",id:"host",show:t.hostField,Cell:e=>E().createElement(ft,{name:e.original.host,maintenance:e.original.hostInMaintenance})},{Header:"Host (Technical Name)",id:"hostTechName",show:t.hostTechNameField,Cell:e=>E().createElement(ft,{name:e.original.hostTechName,maintenance:e.original.hostInMaintenance})},{Header:"Host Groups",accessor:"groups",show:t.hostGroups,Cell:yt},{Header:"Proxy",accessor:"proxy",show:t.hostProxy},{Header:"Severity",show:t.severityField,className:"problem-severity",width:120,accessor:e=>e.priority,id:"severity",Cell:e=>function(e,t,n,r,o=vt){const a=e.original;let s,i;const l=Number(a.severity);return i=u().find(t,(e=>e.priority===l)),a.severity&&"1"===a.value&&(i=u().find(t,(e=>e.priority===l))),s="0"===a.value?o:i.color,n&&"1"===a.acknowledged&&(s=r),E().createElement("div",{className:"severity-cell",style:{background:s}},i.severity)}(e,t.triggerSeverity,t.markAckEvents,t.ackEventColor,t.okEventColor)},{Header:"",id:"statusIcon",show:t.statusIcon,className:"problem-status-icon",width:50,accessor:"value",Cell:e=>function(e,t){const n="0"===e.value?"ok":"problem";let r=!1;t&&(r=v(e.original,t));const o=(0,C.cx)("zbx-problem-status-icon",{"problem-status--new":r},{"zbx-problem":"1"===e.value},{"zbx-ok":"0"===e.value});return E().createElement(se,{status:n,className:o})}(e,n)},{Header:"Status",accessor:"value",show:t.statusField,width:100,Cell:e=>function(e,t){const n="0"===e.value?"RESOLVED":"PROBLEM",r="0"===e.value?vt:bt;let o=!1;return t&&(o=v(e.original,t)),E().createElement("span",{className:o?"problem-status--new":"",style:{color:r}},n)}(e,n)},{Header:"Problem",accessor:"name",minWidth:200,Cell:Et},{Header:"Operational data",accessor:"opdata",show:t.opdataField,width:150,Cell:wt},{Header:"Ack",id:"ack",show:t.ackField,width:70,Cell:e=>E().createElement(pt,e)},{Header:"Tags",accessor:"tags",show:t.showTags,className:"problem-tags",Cell:e=>E().createElement(Ct,ht(mt({},e),{onTagClick:this.handleTagClick}))},{Header:"Age",className:"problem-age",width:100,show:t.ageField,accessor:"timestamp",id:"age",Cell:Pt},{Header:"Time",className:"last-change",width:150,accessor:"timestamp",id:"lastchange",Cell:e=>function(e,t){const n=e.original,r=t||"DD MMM YYYY HH:mm:ss",o=h().unix(n.timestamp).format(r);return E().createElement("span",null,o)}(e,t.customLastChangeFormat&&t.lastChangeFormat)},{Header:"",className:"custom-expander",width:60,expander:!0,Expander:xt}];for(const t of r)(t.show||void 0===t.show)&&(delete t.show,e.push(t));return e}render(){const e=this.buildColumns();this.rootWidth=this.rootRef&&this.rootRef.clientWidth;const{pageSize:t,fontSize:n,panelOptions:r}=this.props,o=(0,C.cx)("panel-problems",{[`font-size--${n}`]:!!n});let a=[5,10,20,25,50,100];return t&&(a.push(t),a=u().uniq(u().sortBy(a))),E().createElement("div",{className:o,ref:this.setRootRef},E().createElement(Z,{data:this.props.problems,columns:e,defaultPageSize:10,pageSize:t,pageSizeOptions:a,resized:r.resizedColumns,minRows:0,loading:this.props.loading,noDataText:"No problems found",SubComponent:e=>E().createElement(lt,ht(mt({},e),{rootWidth:this.rootWidth,timeRange:this.props.timeRange,showTimeline:r.problemTimeline,allowDangerousHTML:r.allowDangerousHTML,panelId:this.props.panelId,getProblemEvents:this.props.getProblemEvents,getProblemAlerts:this.props.getProblemAlerts,getScripts:this.props.getScripts,onProblemAck:this.handleProblemAck,onExecuteScript:this.props.onExecuteScript,onTagClick:this.handleTagClick,subRows:!1})),expanded:this.getExpandedPage(this.state.page),onExpandedChange:this.handleExpandedChange,onPageChange:e=>{(0,w.reportInteraction)("grafana_zabbix_panel_page_change",{action:e>this.state.page?"next":"prev"}),this.setState({page:e})},onPageSizeChange:this.handlePageSizeChange,onResizedChange:this.handleResizedChange}))}constructor(e){super(e),dt(this,"rootWidth",void 0),dt(this,"rootRef",void 0),dt(this,"setRootRef",(e=>{this.rootRef=e})),dt(this,"handleProblemAck",((e,t)=>this.props.onProblemAck(e,t))),dt(this,"onExecuteScript",((e,t)=>{})),dt(this,"handlePageSizeChange",((e,t)=>{this.props.onPageSizeChange&&this.props.onPageSizeChange(e,t)})),dt(this,"handleResizedChange",((e,t)=>{this.props.onColumnResize&&this.props.onColumnResize(e)})),dt(this,"handleExpandedChange",((e,t)=>{(0,w.reportInteraction)("grafana_zabbix_panel_row_expanded",{});const{problems:n,pageSize:r}=this.props,{page:o}=this.state,a={};for(const t in e){const s=r*o+Number(t);if(e[t]&&s<n.length){const e=n[s].eventid;e&&(a[e]=!0)}}const s=mt({},this.state.expanded);s[o]=e;const i=mt({},this.state.expandedProblems);i[o]=a,this.setState({expanded:s,expandedProblems:i})})),dt(this,"handleTagClick",((e,t,n,r)=>{this.props.onTagClick&&this.props.onTagClick(e,t,n,r)})),dt(this,"getExpandedPage",(e=>{const{problems:t,pageSize:n}=this.props,{expandedProblems:r}=this.state,o=r[e]||{},a={},s=n*e,i=Math.min(s+n,t.length);for(let e=s;e<i;e++)o[t[e].eventid]&&(a[e-s]={});return a})),this.rootWidth=0,this.state={expanded:{},expandedProblems:{},page:0}}}const ft=({name:e,maintenance:t})=>E().createElement("div",null,E().createElement("span",{style:{paddingRight:"0.4rem"}},e),t&&E().createElement(ie,{customClass:"fired",icon:"wrench"})),vt="rgb(56, 189, 113)",bt="rgb(215, 0, 0)";function yt(e){let t="";return e.value&&e.value.length&&(t=e.value.map((e=>e.name)).join(", ")),E().createElement("span",null,t)}function Et(e){return E().createElement("div",null,E().createElement("span",{className:"problem-description"},e.value))}function wt(e){const t=e.original;return E().createElement("div",null,E().createElement("span",null,t.opdata))}function Pt(e){const t=e.original,n=h().unix(t.timestamp).fromNow(!0);return E().createElement("span",null,n)}class Ct extends y.PureComponent{render(){return[(this.props.value||[]).map((e=>E().createElement(oe,{key:e.tag+e.value,tag:e,datasource:this.props.original.datasource,onClick:this.handleTagClick})))]}constructor(...e){super(...e),dt(this,"handleTagClick",((e,t,n,r)=>{this.props.onTagClick&&this.props.onTagClick(e,t,n,r)}))}}function xt(e){return E().createElement("span",{className:e.isExpanded?"expanded":""},E().createElement("i",{className:"fa fa-info-circle"}))}class St extends y.PureComponent{render(){const{problem:e}=this.props,t=e.acknowledges&&e.acknowledges.map((e=>E().createElement("tr",{key:e.acknowledgeid},E().createElement("td",null,e.time),E().createElement("td",null,e.user),E().createElement("td",null,e.message))));return E().createElement("div",{className:"ack-tooltip"},E().createElement("table",{className:"table"},E().createElement("thead",null,E().createElement("tr",null,E().createElement("th",{className:"ack-time"},"Time"),E().createElement("th",{className:"ack-user"},"User"),E().createElement("th",{className:"ack-comments"},"Comments"))),E().createElement("tbody",null,t)),e.showAckButton&&E().createElement("div",{className:"ack-add-button"},E().createElement("button",{id:"add-acknowledge-btn",className:"btn btn-mini btn-inverse gf-form-button",onClick:this.handleClick},E().createElement("i",{className:"fa fa-plus"}))))}constructor(...e){super(...e),function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"handleClick",(e=>{this.props.onClick(e)}))}}const kt=({problem:e,color:t,blink:n,highlightBackground:r})=>{const o=Number(e.severity),a="1"===e.value&&o>=2?"critical":"online",s=(0,C.cx)("icon-gf",n&&"zabbix-trigger--blinked"),i=(0,C.cx)("alert-rule-item__icon",!r&&C.css`
        color: ${t};
      `);return E().createElement("div",{className:i},E().createElement(se,{status:a,className:s}))};function Nt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Tt extends y.PureComponent{render(){var e;const{problem:t,panelOptions:n}=this.props,r=n.targets&&n.targets.length>1,o=(0,C.cx)("alert-rule-item","zbx-trigger-card",{"zbx-trigger-highlighted":n.highlightBackground}),a=(0,C.cx)("alert-rule-item__text",{"zbx-description--newline":n.descriptionAtNewLine}),s=Number(t.severity);let i;i=u().find(n.triggerSeverity,(e=>e.priority===s)),t.severity&&(i=u().find(n.triggerSeverity,(e=>e.priority===s)));const c=function(e,t){const n=new Date(1e3*e),r=t||"DD MMM YYYY HH:mm:ss";return l.dateMath.parse(n).format(r)}(t.timestamp,n.customLastChangeFormat&&n.lastChangeFormat),p=h().unix(t.timestamp).fromNow(!0);let d=t.datasource;if(null===(e=t.datasource)||void 0===e?void 0:e.uid){const e=(0,w.getDataSourceSrv)().getInstanceSettings(t.datasource.uid);d=e.name}let m=!1;n.highlightNewerThan&&(m=v(t,n.highlightNewerThan));const g=n.highlightNewEvents&&m;let f;f="0"===t.value?n.okEventColor:n.markAckEvents&&"1"===t.acknowledged?n.ackEventColor:i.color;const b={};return n.highlightBackground&&(b.backgroundColor=f),E().createElement("li",{className:o,style:b},E().createElement(kt,{problem:t,color:f,highlightBackground:n.highlightBackground,blink:g}),E().createElement("div",{className:"alert-rule-item__body"},E().createElement("div",{className:"alert-rule-item__header"},E().createElement("div",{className:"alert-rule-item__name"},E().createElement("span",{className:"zabbix-trigger-name"},t.description),(n.hostField||n.hostTechNameField)&&E().createElement(Ot,{problem:t,panelOptions:n}),n.hostGroups&&E().createElement(zt,{problem:t,panelOptions:n}),n.showTags&&E().createElement("span",{className:"zbx-trigger-tags"},t.tags&&t.tags.map((e=>E().createElement(oe,{key:e.tag+e.value,tag:e,datasource:d,highlight:e.tag===t.correlation_tag,onClick:this.handleTagClick}))))),E().createElement("div",{className:a},n.statusField&&E().createElement(Rt,{problem:t,blink:g}),n.severityField&&E().createElement(Mt,{severityDesc:i,blink:g,highlightBackground:n.highlightBackground}),E().createElement("span",{className:"alert-rule-item__time"},n.ageField&&"for "+p),n.descriptionField&&!n.descriptionAtNewLine&&E().createElement(E().Fragment,null,n.allowDangerousHTML?E().createElement("span",{className:"zbx-description",dangerouslySetInnerHTML:{__html:t.comments}}):E().createElement("span",{className:"zbx-description"},t.comments))),n.descriptionField&&n.descriptionAtNewLine&&E().createElement("div",{className:"alert-rule-item__text zbx-description--newline"},n.allowDangerousHTML?E().createElement("span",{className:"alert-rule-item__info zbx-description",dangerouslySetInnerHTML:{__html:t.comments}}):E().createElement("span",{className:"alert-rule-item__info zbx-description"},t.comments)))),r&&E().createElement("div",{className:"alert-rule-item__time zabbix-trigger-source"},E().createElement("span",null,E().createElement("i",{className:"fa fa-database"}),d)),E().createElement("div",{className:"alert-rule-item__time zbx-trigger-lastchange"},E().createElement("span",null,c||"last change unknown"),E().createElement("div",{className:"trigger-info-block zbx-status-icons"},t.url&&E().createElement("a",{href:t.url,target:"_blank",rel:"noreferrer"},E().createElement("i",{className:"fa fa-external-link"})),"1"===t.state&&E().createElement(ee.Tooltip,{placement:"bottom",content:t.error},E().createElement("span",null,E().createElement("i",{className:"fa fa-question-circle"}))),t.eventid&&E().createElement(Ce,null,(({showModal:e,hideModal:n})=>E().createElement(jt,{problem:t,onClick:()=>{e(Oe,{canClose:"1"===t.manual_close,severity:s,onSubmit:this.ackProblem,onDismiss:n})}}))))))}constructor(...e){super(...e),Nt(this,"handleTagClick",((e,t,n,r)=>{this.props.onTagClick&&this.props.onTagClick(e,t,n,r)})),Nt(this,"ackProblem",(e=>{const t=this.props.problem;return this.props.onProblemAck(t,e)}))}}function Ot(e){const t=e.problem,n=e.panelOptions;let r="";return n.hostField&&n.hostTechNameField?r=`${t.host} (${t.hostTechName})`:(n.hostField||n.hostTechNameField)&&(r=n.hostField?t.host:t.hostTechName),n.hostProxy&&t.proxy&&(r=`${t.proxy}: ${r}`),E().createElement("span",{className:"zabbix-hostname"},t.maintenance&&E().createElement("i",{className:"fa fa-wrench zbx-maintenance-icon"}),r)}function zt(e){const t=e.problem;let n="";return e.panelOptions.hostGroups&&(n+=`[ ${u().map(t.groups,"name").join(", ")} ]`),E().createElement("span",{className:"zabbix-hostname"},n)}const Ft="rgb(56, 189, 113)",Dt="rgb(215, 0, 0)";function Rt(e){const{problem:t,okColor:n,problemColor:r,blink:o}=e,a="0"===t.value?"RESOLVED":"PROBLEM",s="0"===t.value?n||Ft:r||Dt,i=(0,C.cx)("zbx-trigger-state",{"alert-state-critical":"1"===t.value},{"alert-state-ok":"0"===t.value},{"zabbix-trigger--blinked":o});return E().createElement("span",{className:i,style:{color:s}},a)}function Mt(e){const{severityDesc:t,highlightBackground:n,blink:r}=e,o=(0,C.cx)("zbx-trigger-severity",{"zabbix-trigger--blinked":r}),a={};return n||(a.color=t.color),E().createElement("span",{className:o,style:a},t.severity)}class jt extends y.PureComponent{render(){const{problem:e}=this.props;let t=null;return e.acknowledges&&e.acknowledges.length?t=E().createElement(ee.Tooltip,{placement:"auto",content:this.renderTooltipContent,interactive:!0},E().createElement("span",null,E().createElement("i",{className:"fa fa-comments"}))):e.showAckButton&&(t=E().createElement(ee.Tooltip,{placement:"bottom",content:"Acknowledge problem"},E().createElement("span",{role:"button",onClick:this.handleClick},E().createElement("i",{className:"fa fa-comments-o"})))),t}constructor(...e){super(...e),Nt(this,"handleClick",(e=>{this.props.onClick(e)})),Nt(this,"renderTooltipContent",(()=>E().createElement(St,{problem:this.props.problem,onClick:this.handleClick})))}}function Ht(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class At extends y.PureComponent{getCurrentProblems(e){const{pageSize:t,problems:n}=this.props,r=t*e,o=Math.min(t*(e+1),n.length);return this.props.problems.slice(r,o)}render(){const{problems:e,panelOptions:t}=this.props,n=this.getCurrentProblems(this.state.page);let r=parseInt(t.fontSize.slice(0,t.fontSize.length-1),10);r=r&&100!==r?r:null;const o=(0,C.cx)("alert-rule-list",{[`font-size--${r}`]:!!r});return E().createElement("div",{className:"triggers-panel-container",key:"alertListContainer"},E().createElement("section",{className:"card-section card-list-layout-list"},E().createElement("ol",{className:o},n.map(((e,n)=>{var r;return E().createElement(Tt,{key:`${e.triggerid}-${e.eventid}-${(null===(r=e.datasource)||void 0===r?void 0:r.uid)||e.datasource}-${n}`,problem:e,panelOptions:t,onTagClick:this.handleTagClick,onProblemAck:this.handleProblemAck})})))),E().createElement("div",{className:"triggers-panel-footer",key:"alertListFooter"},E().createElement($t,{itemsLength:e.length,pageSize:this.props.pageSize,pageIndex:this.state.page,onPageChange:this.handlePageChange})))}constructor(e){super(e),Ht(this,"handlePageChange",(e=>{const t=this.getCurrentProblems(e);this.setState({page:e,currentProblems:t})})),Ht(this,"handleTagClick",((e,t,n,r)=>{this.props.onTagClick&&this.props.onTagClick(e,t,n,r)})),Ht(this,"handleProblemAck",((e,t)=>this.props.onProblemAck(e,t))),this.state={page:0,currentProblems:this.getCurrentProblems(0)}}}class $t extends y.PureComponent{render(){const{itemsLength:e,pageIndex:t,pageSize:n}=this.props,r=Math.ceil(e/n);if(1===r)return E().createElement("ul",null);const o=Math.max(t-3,0),a=Math.min(r,o+9),s=[];for(let e=o;e<a;e++){const n=(0,C.cx)("triggers-panel-page-link","pointer",{active:e===t}),r=e+1,o=E().createElement("li",{key:r.toString()},E().createElement("a",{className:n,onClick:this.handlePageChange(e)},r));s.push(o)}return E().createElement("ul",null,s)}constructor(...e){super(...e),Ht(this,"handlePageChange",(e=>()=>{this.props.onPageChange(e)}))}}function Bt(e,t,n,r,o,a,s){try{var i=e[a](s),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(r,o)}function _t(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function s(e){Bt(a,r,o,s,i,"next",e)}function i(e){Bt(a,r,o,s,i,"throw",e)}s(void 0)}))}}function It(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Wt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){It(e,t,n[t])}))}return e}function Lt(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}const Gt={schemaVersion:8,hostField:!0,hostTechNameField:!1,hostProxy:!1,hostGroups:!1,showTags:!0,statusField:!0,statusIcon:!1,severityField:!0,ackField:!0,ageField:!1,opdataField:!1,descriptionField:!0,descriptionAtNewLine:!1,sortProblems:"lastchange",limit:void 0,layout:"table",fontSize:"100%",pageSize:10,problemTimeline:!0,highlightBackground:!1,highlightNewEvents:!1,highlightNewerThan:"1h",customLastChangeFormat:!1,lastChangeFormat:"",resizedColumns:[],allowDangerousHTML:!1,triggerSeverity:[{priority:0,severity:"Not classified",color:"rgb(108, 108, 108)",show:!0},{priority:1,severity:"Information",color:"rgb(120, 158, 183)",show:!0},{priority:2,severity:"Warning",color:"rgb(175, 180, 36)",show:!0},{priority:3,severity:"Average",color:"rgb(255, 137, 30)",show:!0},{priority:4,severity:"High",color:"rgb(255, 101, 72)",show:!0},{priority:5,severity:"Disaster",color:"rgb(215, 0, 0)",show:!0}],okEventColor:"rgb(56, 189, 113)",ackEventColor:"rgb(56, 219, 156)",markAckEvents:!1},Kt=({onChange:e})=>E().createElement(ee.Button,{variant:"secondary",onClick:()=>e([])},"Reset columns");function Vt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ut(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Vt(e,t,n[t])}))}return e}function Jt(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}const qt=({value:e,onChange:t})=>{const n=n=>{e.forEach(((t,r)=>{t.priority===n.priority&&(e[r]=n)})),t(e)};return E().createElement(E().Fragment,null,e.map(((e,t)=>E().createElement(Yt,{key:`${e.priority}-${t}`,value:e,onChange:e=>n(e)}))))},Yt=({value:e,onChange:t})=>E().createElement(ee.VerticalGroup,null,E().createElement(ee.InlineFieldRow,null,E().createElement(ee.InlineField,{labelWidth:12},E().createElement(ee.Input,{width:24,defaultValue:e.severity,onBlur:n=>{var r;const o=null==n||null===(r=n.currentTarget)||void 0===r?void 0:r.value;null!==o&&t(Jt(Ut({},e),{severity:o}))}})),E().createElement(ee.InlineLabel,{width:4},E().createElement(ee.ColorPicker,{color:e.color,onChange:n=>t(Jt(Ut({},e),{color:n}))})),E().createElement(ee.InlineField,{label:"Show"},E().createElement(ee.InlineSwitch,{value:e.show,onChange:()=>t(Jt(Ut({},e),{show:!e.show}))}))));(0,w.loadPluginCss)({dark:"plugins/alexanderzobnin-zabbix-app/styles/dark.css",light:"plugins/alexanderzobnin-zabbix-app/styles/light.css"});const Xt=new l.PanelPlugin((e=>{const{data:t,options:n,timeRange:r,onOptionsChange:o}=e,{layout:a,showTriggers:s,triggerSeverity:i,sortProblems:c}=n,p=()=>{const e=[];if(!(null==t?void 0:t.series))return[];for(const n of t.series)try{const t=n.fields[0].values;t.toArray&&e.push(...t.toArray())}catch(e){return console.log(e),[]}let n=u().cloneDeep(e);return n=n.map((e=>h(e))),n=d(n),n=m(n),n},d=e=>{let t=u().cloneDeep(e);return"unacknowledged"===s?t=t.filter((e=>!(e.acknowledges&&e.acknowledges.length))):"acknowledged"===s&&(t=t.filter((e=>e.acknowledges&&e.acknowledges.length))),t=t.filter((e=>{const t=void 0!==e.severity?Number(e.severity):Number(e.priority);return i[t].show})),t},m=e=>("priority"===c?e=u().orderBy(e,["severity","timestamp","eventid"],["desc","desc","desc"]):"lastchange"===c&&(e=u().orderBy(e,["timestamp","severity","eventid"],["desc","desc","desc"])),e),h=e=>{const t=u().cloneDeep(e);if(t.hosts&&t.hosts.length){const e=t.hosts[0];t.host=e.name,t.hostTechName=e.host,e.proxy&&(t.proxy=e.proxy)}return t.tags&&0===t.tags.length&&(t.tags=void 0),t.comments&&n.allowDangerousHTML&&(t.comments=t.comments.replace("\n","<br>")),t.lastchangeUnix=Number(t.lastchange),t},f=e=>{if(!e)return[];const t=u().map(e.split(","),(e=>e.trim()));return u().map(t,(e=>{const t=e.split(":");return{tag:t[0].trim(),value:t[1].trim()}}))},v=e=>u().map(e,(e=>`${e.tag}:${e.value}`)).join(", "),b=(y=_t((function*(e){const t=[e.triggerid],n=Math.ceil(l.dateMath.parse(r.from).unix()),o=Math.ceil(l.dateMath.parse(r.to).unix());return(yield(0,w.getDataSourceSrv)().get(e.datasource)).zabbix.getEvents(t,n,o,[0,1],100)})),function(e){return y.apply(this,arguments)});var y;const C=function(){var e=_t((function*(e){if(!e.eventid)return Promise.resolve([]);const t=[e.eventid];return(yield(0,w.getDataSourceSrv)().get(e.datasource)).zabbix.getEventAlerts(t)}));return function(t){return e.apply(this,arguments)}}(),x=function(){var e=_t((function*(e){var t;const n=(null===(t=e.hosts)||void 0===t?void 0:t.length)?e.hosts[0].hostid:null;return(yield(0,w.getDataSourceSrv)().get(e.datasource)).zabbix.getScripts([n])}));return function(t){return e.apply(this,arguments)}}(),S=function(){var e=_t((function*(e,t){var n;const r=(null===(n=e.hosts)||void 0===n?void 0:n.length)?e.hosts[0].hostid:null;return(yield(0,w.getDataSourceSrv)().get(e.datasource)).zabbix.executeScript(r,t)}));return function(t,n){return e.apply(this,arguments)}}(),k=function(){var e=_t((function*(e,t){const{message:n,action:r,severity:o}=t,a=e.eventid,s=P.contextSrv.user.name+" (Grafana): "+n,i=yield(0,w.getDataSourceSrv)().get(e.datasource),l=P.contextSrv.isEditor||P.contextSrv.isGrafanaAdmin;return i.disableReadOnlyUsersAck&&!l?{message:"You have no permissions to acknowledge events."}:a?i.zabbix.acknowledgeEvent(a,s,r,o):{message:"Trigger has no events. Nothing to acknowledge."}}));return function(t,n){return e.apply(this,arguments)}}(),N=(e,t)=>{o(Lt(Wt({},n),{pageSize:e}))},T=e=>{o(Lt(Wt({},n),{resizedColumns:e}))},O=(n,r,o,a)=>{o||a?((n,r)=>{var o;const a=e=>e.tag===n.tag&&e.value===n.value,s=null===(o=t.request)||void 0===o?void 0:o.targets;let i=!1;for(const e of s){var l;if((null===(l=e.datasource)||void 0===l?void 0:l.uid)===(null==r?void 0:r.uid)||e.datasource===r){var c;const t=null===(c=e.tags)||void 0===c?void 0:c.filter;let n=f(t);u().remove(n,a),n=u().uniqWith(n,u().isEqual);const r=v(n);e.tags.filter=r,i=!0}}if(i){const t=new g(s);e.eventBus.publish(t)}})(n,r):((n,r)=>{var o;const a=null===(o=t.request)||void 0===o?void 0:o.targets;let s=!1;for(const e of a){var i;if((null===(i=e.datasource)||void 0===i?void 0:i.uid)===(null==r?void 0:r.uid)||e.datasource===r){var l;const t=null===(l=e.tags)||void 0===l?void 0:l.filter;let r=f(t);const o={tag:n.tag,value:n.value};r.push(o),r=u().uniqWith(r,u().isEqual);const a=v(r);e.tags.filter=a,s=!0}}if(s){const t=new g(a);e.eventBus.publish(t)}})(n,r)};return E().createElement(E().Fragment,null,"list"===a&&(()=>{const e=p(),t=parseInt(n.fontSize.slice(0,n.fontSize.length-1),10),r=t&&100!==t?t:void 0;return E().createElement(At,{problems:e,panelOptions:n,pageSize:n.pageSize,fontSize:r,onProblemAck:k,onTagClick:O})})(),"table"===a&&(()=>{const e=p(),t=parseInt(n.fontSize.slice(0,n.fontSize.length-1),10),o=t&&100!==t?t:void 0;return E().createElement(gt,{problems:e,panelOptions:n,pageSize:n.pageSize,fontSize:o,timeRange:r,getProblemEvents:b,getProblemAlerts:C,getScripts:x,onExecuteScript:S,onProblemAck:k,onColumnResize:T,onPageSizeChange:N,onTagClick:O})})())})).setPanelChangeHandler(((e,t,n)=>{var r;return null!==(r=e.options)&&void 0!==r?r:{}})).setMigrationHandler((e=>{var t,n;let r=null!==(n=e.options)&&void 0!==n?n:{};var o;return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){b(e,t,n[t])}))}return e}({},{layout:e.layout,hostField:e.hostField,hostTechNameField:e.hostTechNameField,hostGroups:e.hostGroups,hostProxy:e.hostProxy,showTags:e.showTags,statusField:e.statusField,statusIcon:e.statusIcon,severityField:e.severityField,ackField:e.ackField,ageField:e.ageField,descriptionField:e.descriptionField,descriptionAtNewLine:e.descriptionAtNewLine,hostsInMaintenance:e.hostsInMaintenance,showTriggers:e.showTriggers,sortProblems:e.sortProblems,limit:e.limit,fontSize:e.fontSize,pageSize:e.pageSize,problemTimeline:e.problemTimeline,highlightBackground:e.highlightBackground,highlightNewEvents:e.highlightNewEvents,highlightNewerThan:e.highlightNewerThan,customLastChangeFormat:e.customLastChangeFormat,lastChangeFormat:e.lastChangeFormat,resizedColumns:e.resizedColumns,triggerSeverity:e.triggerSeverity,okEventColor:e.okEventColor,ackEventColor:e.ackEventColor,markAckEvents:e.markAckEvents,showEvents:null!==(o=null===(t=e.showEvents)||void 0===t?void 0:t.value)&&void 0!==o?o:e.showEvents},r)})).setPanelOptions((e=>{e.addSelect({path:"layout",name:"Layout",defaultValue:Gt.layout,settings:{options:[{label:"Table",value:"table"},{label:"List",value:"list"}]}}).addSelect({path:"sortProblems",name:"Sort by",defaultValue:Gt.sortProblems,settings:{options:[{label:"Default",value:"default"},{label:"Last change",value:"lastchange"},{label:"Severity",value:"priority"}]}}).addSelect({path:"fontSize",name:"Font size",defaultValue:Gt.fontSize,settings:{options:Qt}}).addNumberInput({path:"pageSize",name:"Page size",defaultValue:Gt.pageSize}).addBooleanSwitch({path:"problemTimeline",name:"Problem timeline",defaultValue:Gt.problemTimeline,showIf:e=>"table"===e.layout}).addBooleanSwitch({path:"highlightBackground",name:"Highlight background",defaultValue:Gt.highlightBackground,showIf:e=>"list"===e.layout}).addBooleanSwitch({path:"highlightNewEvents",name:"Highlight new events",defaultValue:Gt.highlightNewEvents}).addTextInput({path:"highlightNewerThan",name:"Newer than",defaultValue:Gt.highlightNewerThan,showIf:e=>e.highlightNewEvents}).addBooleanSwitch({path:"customLastChangeFormat",name:"Custom last change format",defaultValue:Gt.customLastChangeFormat}).addTextInput({path:"lastChangeFormat",name:"Last change format",defaultValue:Gt.lastChangeFormat,description:"See moment.js dosc for time format http://momentjs.com/docs/#/displaying/format/",settings:{placeholder:"dddd, MMMM Do YYYY, h:mm:ss a"},showIf:e=>e.customLastChangeFormat}).addBooleanSwitch({path:"allowDangerousHTML",name:"Allow HTML",description:"Format problem description and other data as HTML. Use with caution, it's potential cross-site scripting (XSS) vulnerability.",defaultValue:Gt.allowDangerousHTML}).addCustomEditor({id:"resetColumns",path:"resizedColumns",name:"Reset resized columns",editor:Kt,showIf:e=>"table"===e.layout}).addCustomEditor({id:"triggerColors",path:"triggerSeverity",name:"Problem colors",editor:qt,defaultValue:Gt.triggerSeverity,category:["Colors"]}).addBooleanSwitch({path:"markAckEvents",name:"Mark acknowledged events",defaultValue:Gt.markAckEvents,category:["Colors"]}).addColorPicker({path:"ackEventColor",name:"Acknowledged color",defaultValue:Gt.ackEventColor,showIf:e=>e.markAckEvents,settings:[{enableNamedColors:!1}],category:["Colors"]}).addColorPicker({path:"okEventColor",name:"OK event color",defaultValue:Gt.okEventColor,settings:[{enableNamedColors:!1}],category:["Colors"]}).addBooleanSwitch({path:"hostField",name:"Host name",defaultValue:Gt.hostField,category:["Fields"]}).addBooleanSwitch({path:"hostTechNameField",name:"Technical name",defaultValue:Gt.hostTechNameField,category:["Fields"]}).addBooleanSwitch({path:"hostGroups",name:"Host groups",defaultValue:Gt.hostGroups,category:["Fields"]}).addBooleanSwitch({path:"hostProxy",name:"Host proxy",defaultValue:Gt.hostProxy,category:["Fields"]}).addBooleanSwitch({path:"showTags",name:"Tags",defaultValue:Gt.showTags,category:["Fields"]}).addBooleanSwitch({path:"statusField",name:"Status",defaultValue:Gt.statusField,category:["Fields"]}).addBooleanSwitch({path:"statusIcon",name:"Status icon",defaultValue:Gt.statusIcon,category:["Fields"]}).addBooleanSwitch({path:"severityField",name:"Severity",defaultValue:Gt.severityField,category:["Fields"]}).addBooleanSwitch({path:"ackField",name:"Ack",defaultValue:Gt.ackField,category:["Fields"]}).addBooleanSwitch({path:"ageField",name:"Age",defaultValue:Gt.ageField,category:["Fields"]}).addBooleanSwitch({path:"opdataField",name:"Operational data",defaultValue:Gt.opdataField,category:["Fields"]}).addBooleanSwitch({path:"descriptionField",name:"Description",defaultValue:Gt.descriptionField,showIf:e=>"list"===e.layout,category:["Fields"]}).addBooleanSwitch({path:"descriptionAtNewLine",name:"At the new line",defaultValue:Gt.descriptionAtNewLine,showIf:e=>"list"===e.layout,category:["Fields"]})})),Qt=[{label:"80%",value:"80%"},{label:"90%",value:"90%"},{label:"100%",value:"100%"},{label:"110%",value:"110%"},{label:"120%",value:"120%"},{label:"130%",value:"130%"},{label:"150%",value:"150%"},{label:"160%",value:"160%"},{label:"180%",value:"180%"},{label:"200%",value:"200%"},{label:"220%",value:"220%"},{label:"250%",value:"250%"}]})(),d})()));
//# sourceMappingURL=module.js.map